<!DOCTYPE html>
<html lang="en"><head>
<script src="L06-lasso_files/libs/clipboard/clipboard.min.js"></script>
<script src="L06-lasso_files/libs/quarto-html/tabby.min.js"></script>
<script src="L06-lasso_files/libs/quarto-html/popper.min.js"></script>
<script src="L06-lasso_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="L06-lasso_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="L06-lasso_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="L06-lasso_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="L06-lasso_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.555">

  <title>LASSO: Shrinkage / Regularization</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="L06-lasso_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="L06-lasso_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="L06-lasso_files/libs/revealjs/dist/theme/quarto.css">
  <link href="L06-lasso_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="L06-lasso_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="L06-lasso_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="L06-lasso_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="L06-lasso_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="L06-lasso_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">LASSO: Shrinkage / Regularization</h1>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="settling-in" class="title-slide slide level1 unnumbered smaller center">
<h1>Settling In</h1>
<ul>
<li>Sit with the same group as last class.
<ul>
<li>Last day with these groups!</li>
<li>Fill out the Group 1 Feedback Survey on Moodle to help me pick new ones.</li>
</ul></li>
<li>Prepare to take notes.
<ul>
<li><a href="schedule.html">Locate</a>, download, save, and open the QMD for today’s class</li>
<li>NOTE: I moved the R code notes to the <em>end</em> of the QMD, but kept the <code>eval = FALSE</code> chunks. If you don’t like these, you can do a find-and-replace to move them, but you won’t be able to render your document right away.</li>
</ul></li>
</ul>
</section>
<section id="announcements" class="slide level2 unnumbered smaller">
<h2>Announcements</h2>
<ul>
<li>See the #announcements channel on <a href="https://macstat253.slack.com">Slack</a> for upcoming events.</li>
<li>Check out this Minnesota Public Radio (MPR) interview on <a href="https://www.mprnews.org/episode/2023/09/19/can-ai-replace-your-doctor">Can AI replace your doctor?</a>! It’s a discussion of AI / machine learning in medicine. NOTE: ML is a subset of AI. (image from Wiki)</li>
</ul>
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/AI-ML-DL.svg/440px-AI-ML-DL.svg.png" width="300"></p>
<ul>
<li>Now that we’re on MPR, journalist <a href="http://dhmontgomery.com/portfolio/">David Montgomery</a> used R for data analysis and visualizations using this <a href="https://github.com/dhmontgomery/personal-work/tree/master/theme-mpr">custom ggtheme</a> to make visuals for MPR. To create a custom ggtheme, check out <a href="https://themockup.blog/posts/2020-12-26-creating-and-using-custom-ggplot2-themes/" class="uri">https://themockup.blog/posts/2020-12-26-creating-and-using-custom-ggplot2-themes/</a>.</li>
<li>Interested in the intersection between statistics/data science and journalism? Consider applying for <a href="https://recruiting2.ultipro.com/STA1013/JobBoard/94aec289-5757-a8f0-d3bb-77f9cd846172/OpportunityDetail?opportunityId=bd90fff9-acf2-4e04-b8b6-497965cde9a7">this internship</a> with the Star Tribune! (<strong>Deadline: Friday, November 1</strong>)</li>
</ul>
</section></section>
<section id="learning-goals" class="title-slide slide level1 unnumbered smaller center">
<h1>Learning Goals</h1>
<ul>
<li>Explain how ordinary and penalized least squares are similar and different with regard to (1) the form of the objective function and (2) the goal of variable selection</li>
<li>Explain why variable scaling is important for the performance of shrinkage methods</li>
<li>Explain how the lambda tuning parameter affects model performance and how this is related to overfitting</li>
<li>Describe how output from LASSO models can give a measure of <em>variable importance</em></li>
</ul>
<!-- DETAILS FOR INSTRUCTOR: -->
<!-- LASSO drawback: when large p / small n, (1) LASSO selects at most n predictors, (2) tends to only pick 1 of a group of correlated predictors -->
<!-- Including the quadratic ridge penalty produces a unique minimum -->
<!-- - Why does LASSO set coef to 0?  The idea is that the LASSO penalty constrains coefficients to be within a multidimensional diamond that has a large number of corners (at which coefficients are set to 0) whereas the ridge penalty constrains coefficients to be within a smooth boundary. -->
</section>

<section>
<section id="notes-lasso" class="title-slide slide level1 unnumbered center">
<h1>Notes: LASSO</h1>

</section>
<section id="context" class="slide level2 unnumbered smaller">
<h2>Context</h2>
<center>
<img src="images/MLDiagram2.jpg">
</center>
<ul>
<li><p><strong>world = supervised learning</strong><br>
We want to model some output variable <span class="math inline">\(y\)</span> using a set of <em>potential</em> predictors (<span class="math inline">\(x_1, x_2, ..., x_p\)</span>).</p></li>
<li><p><strong>task = regression</strong><br>
<span class="math inline">\(y\)</span> is quantitative</p></li>
<li><p><strong>model = linear regression</strong><br>
We’ll assume that the relationship between <span class="math inline">\(y\)</span> and (<span class="math inline">\(x_1, x_2, ..., x_p\)</span>) can be represented by</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \varepsilon\]</span></p></li>
<li><p><span style="background-color:lightgray;"><strong>estimation algorithm = LASSO</strong></span> (instead of least squares)</p></li>
</ul>
<p><br><br></p>
</section>
<section id="least-absolute-shrinkage-and-selection-operator" class="slide level2 unnumbered smaller">
<h2>Least Absolute Shrinkage and Selection Operator</h2>
<p><strong>LASSO:</strong> <strong>L</strong>east <strong>A</strong>bsolute <strong>S</strong>hrinkage and <strong>S</strong>election <strong>O</strong>perator</p>
<div>
<p>Dates back to 1996, proposed by Robert Tibshirani (one of the authors of ISLR)</p>
<blockquote>
<p>Robert Tibshirani, Regression Shrinkage and Selection Via the Lasso, Journal of the Royal Statistical Society: Series B (Methodological), Volume 58, Issue 1, January 1996, Pages 267–288, <a href="https://doi.org/10.1111/j.2517-6161.1996.tb02080.x">https://doi.org/10.1111/j.2517-6161.1996.tb02080.x</a></p>
</blockquote>
</div>
</section>
<section id="goal" class="slide level2 unnumbered smaller">
<h2>Goal</h2>
<p><strong>GOAL: Model Selection</strong></p>
<p>Use the LASSO algorithm to help us <em>regularize</em> and <em>select</em> the “best” predictors <span class="math inline">\(x\)</span> to use in a <strong>predictive</strong> linear regression model of <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[y = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \cdots + \hat{\beta}_p x_p + \varepsilon\]</span></p>
</section>
<section id="idea" class="slide level2 unnumbered smaller">
<h2>Idea</h2>
<ul>
<li><em>Penalize</em> a predictor for adding complexity to the model (by penalizing its coefficient).</li>
<li>Track whether the predictor’s <em>contribution</em> to the model (lowering RSS) is enough to offset this penalty.</li>
</ul>
</section>
<section id="algorithm-criterion" class="slide level2 unnumbered smaller">
<h2>Algorithm Criterion</h2>
<p>Identify the model coefficients <span class="math inline">\(\hat{\beta}_1, \hat{\beta}_2, ...  \hat{\beta}_p\)</span> that <em>minimize</em> the <strong>penalized residual sum of squares</strong>:</p>
<p><span class="math display">\[RSS + \lambda \sum_{j=1}^p \vert \hat{\beta}_j\vert = \sum_{i=1}^n (y_i - \hat{y}_i)^2 + \lambda \sum_{j=1}^p \vert \hat{\beta}_j\vert\]</span></p>
<p>where</p>
<ul>
<li>residual sum of squares (RSS) measures the overall model prediction error</li>
<li>the penalty term measures the overall size of the model coefficients</li>
<li><span class="math inline">\(\lambda \ge 0\)</span> (“lambda”) is a tuning parameter</li>
</ul>
</section></section>
<section>
<section id="small-group-discussion" class="title-slide slide level1 unnumbered center">
<h1>Small Group Discussion</h1>
<p>Discuss basic understanding from the video to help each other clear up concepts.</p>
</section>
<section id="questions" class="slide level2 unnumbered smaller scrollable">
<h2>Questions</h2>
<p><strong>1: LASSO vs other algorithms for building linear regression models</strong></p>
<ol type="a">
<li>LASSO vs least squares
<ul>
<li>What’s one advantage of LASSO vs least squares?</li>
<li>Which algorithm(s) require us (or R) to <em>scale</em> the predictors?</li>
</ul></li>
<li>What is one advantage of LASSO vs backward stepwise selection?</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li>LASSO helps with model selection, i.e.&nbsp;kicks some predictors out of the model, and preventing overfitting.</li>
<li>LASSO isn’t greedy and doesn’t overestimate the significance of the predictors it retains (its variable selection isn’t based on p-values).</li>
</ol>
</details>
<p><br></p>
<p><strong>2: LASSO tuning</strong></p>
<p>We have to pick a <span class="math inline">\(\lambda\)</span> penalty tuning parameter for our LASSO model. What’s the impact of <span class="math inline">\(\lambda\)</span>?</p>
<ol type="a">
<li>When <span class="math inline">\(\lambda\)</span> is 0, …</li>
<li>As <span class="math inline">\(\lambda\)</span> increases, the predictor coefficients ….</li>
<li><strong>Goldilocks problem</strong>: If <span class="math inline">\(\lambda\)</span> is too big, …. If <span class="math inline">\(\lambda\)</span> is too small, …</li>
<li>To decide between a LASSO that uses <span class="math inline">\(\lambda = 0.01\)</span> vs <span class="math inline">\(\lambda = 0.1\)</span> (for example), we can ….</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li>LASSO is equivalent to least squares.</li>
<li>shrink toward or to 0.</li>
<li>too big: all predictors are kicked out of the model. too small: too few predictors are kicked out, hence the model is complicated and maybe overfit.</li>
<li>compare CV MAE of the LASSOs with these <span class="math inline">\(\lambda\)</span></li>
</ol>
</details>
<p><br></p>
<p><strong>COMMENT: Picking <span class="math inline">\(\lambda\)</span></strong></p>
<p>We <em>cannot</em> know the “best” value for <span class="math inline">\(\lambda\)</span> in advance. This varies from analysis to analysis.</p>
<p>We must try a reasonable <em>range</em> of possible values for <span class="math inline">\(\lambda\)</span>. This also varies from analysis to analysis.</p>
<p>In general, we have to use <em>trial-and-error</em> to identify a range that is…</p>
<ul>
<li>wide enough that it doesn’t miss the best values for <span class="math inline">\(\lambda\)</span></li>
<li>narrow enough that it focuses on reasonable values for <span class="math inline">\(\lambda\)</span></li>
</ul>
</section></section>
<section>
<section id="exercises" class="title-slide slide level1 unnumbered center">
<h1>Exercises</h1>

</section>
<section id="instructions" class="slide level2 unnumbered smaller">
<h2>Instructions</h2>
<ul>
<li>Open the QMD fo today and scroll down to the <em>Exercises</em></li>
<li>Work on implementing LASSO to familiar data</li>
<li>Become familiar with the new code <strong>structures</strong>:
<ul>
<li>instead of <code>fit_resamples</code> to run CV, we’ll use <code>tune_grid</code> to tune the algorithm with CV</li>
<li>new engine: <code>set_engine('glmnet')</code></li>
<li>in general: focus on the concepts over the R code</li>
</ul></li>
<li>As always:
<ul>
<li>Be kind to yourself/each other</li>
<li>Collaborate</li>
<li>Ask me questions as I move around the room</li>
</ul></li>
</ul>
</section>
<section id="questions-1" class="slide level2 unnumbered smaller scrollable">
<h2>Questions</h2>
<p>We’ll use the LASSO algorithm to help us build a good <em>predictive</em> model of <code>height</code> using the collection of 12 possible predictors in the <code>humans</code> dataset:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co"># Load packages</span></span>
<span id="cb1-2"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href=""></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-4"><a href=""></a></span>
<span id="cb1-5"><a href=""></a><span class="co"># Resolves package conflicts by preferring tidymodels functions</span></span>
<span id="cb1-6"><a href=""></a><span class="fu">tidymodels_prefer</span>()</span>
<span id="cb1-7"><a href=""></a></span>
<span id="cb1-8"><a href=""></a><span class="co"># Load data</span></span>
<span id="cb1-9"><a href=""></a>humans <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://kegrinde.github.io/stat253_coursenotes/data/bodyfat2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
<br>
</p>
<p>Let’s implement the LASSO. We’ll pause to examine the code. The R code notes section, below, and R code tutorial provide more detail, so no need to take notes here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="co"># STEP 1: LASSO algorithm / model specification</span></span>
<span id="cb2-2"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: we're using a new engine now: glmnet instead of lm</span></span>
<span id="cb2-3"><a href=""></a>lasso_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span>             </span>
<span id="cb2-4"><a href=""></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href=""></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>) <span class="sc">%&gt;%</span>                 </span>
<span id="cb2-6"><a href=""></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>())  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="co"># STEP 2: variable recipe</span></span>
<span id="cb3-2"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: "y ~ ." is shorthand for "y as a function of all other variables"</span></span>
<span id="cb3-3"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: We'll discuss step_dummy() next class.</span></span>
<span id="cb3-4"><a href=""></a>variable_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(height <span class="sc">~</span> ., <span class="at">data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href=""></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co"># STEP 3: workflow specification (model + recipe)</span></span>
<span id="cb4-2"><a href=""></a>lasso_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href=""></a>  <span class="fu">add_recipe</span>(variable_recipe) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href=""></a>  <span class="fu">add_model</span>(lasso_spec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="co"># STEP 4: Estimate 50 LASSO models using</span></span>
<span id="cb5-2"><a href=""></a><span class="co"># lambda values on a "grid" or range from 10^(-5) to 10^(-0.1).</span></span>
<span id="cb5-3"><a href=""></a><span class="co"># Calculate the CV MAE for each of the 50 models.</span></span>
<span id="cb5-4"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: we use tune_grid instead of fit_resamples to run CV</span></span>
<span id="cb5-5"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: I usually start with a range from 10^(-5) to 10^1 and tweak through trial-and-error.</span></span>
<span id="cb5-6"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">253</span>)</span>
<span id="cb5-7"><a href=""></a>lasso_models <span class="ot">&lt;-</span> lasso_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href=""></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb5-9"><a href=""></a>    <span class="at">grid =</span> <span class="fu">grid_regular</span>(<span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="fl">0.1</span>)), <span class="at">levels =</span> <span class="dv">50</span>),  </span>
<span id="cb5-10"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(humans, <span class="at">v =</span> <span class="dv">10</span>),   </span>
<span id="cb5-11"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae)</span>
<span id="cb5-12"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li><strong>Examining the impact of <span class="math inline">\(\lambda\)</span></strong></li>
</ol>
<p>Let’s compare the CV MAEs (y-axis) for our <strong>50</strong> LASSO models which used 50 different <span class="math inline">\(\lambda\)</span> values (x-axis):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="fu">autoplot</span>(lasso_models) <span class="sc">+</span> </span>
<span id="cb6-2"><a href=""></a>  <span class="fu">scale_x_continuous</span>() <span class="sc">+</span> </span>
<span id="cb6-3"><a href=""></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li>We told R to use a range of <span class="math inline">\(\lambda\)</span> from -5 to -0.1 on the log10 scale. Calculate this range on the non-log scale and confirm that it matches the x-axis.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co">#: eval: false</span></span>
<span id="cb7-2"><a href=""></a><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">5</span>)</span>
<span id="cb7-3"><a href=""></a><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>Explain why this plot displays the “Goldilocks” problem of tuning <span class="math inline">\(\lambda\)</span>.</li>
</ol>
<details>
<summary>
Solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="fu">autoplot</span>(lasso_models) <span class="sc">+</span> </span>
<span id="cb8-2"><a href=""></a>  <span class="fu">scale_x_continuous</span>() <span class="sc">+</span> </span>
<span id="cb8-3"><a href=""></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="L06-lasso_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<ol type="a">
<li>Yep it matches.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7943282</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>CV MAE is large when <span class="math inline">\(\lambda\)</span> is either too small or too big.</li>
</ol>
</details>
<p><br></p>
<ol start="2" type="1">
<li><strong>Picking a <span class="math inline">\(\lambda\)</span> value</strong></li>
</ol>
<ol type="a">
<li>In the plot above, roughly which value of the <span class="math inline">\(\lambda\)</span> penalty parameter produces the <em>smallest</em> CV MAE? Check your approximation:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a>best_penalty <span class="ot">&lt;-</span> lasso_models <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href=""></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mae"</span>)</span>
<span id="cb13-3"><a href=""></a></span>
<span id="cb13-4"><a href=""></a>best_penalty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>Suppose we prefer a parsimonious model. The plot below adds error bars to the CV MAE <em>estimates</em> of prediction error (+/- one standard error). Any model with a CV MAE that falls within another model’s error bars is not significantly better or worse at prediction:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="co"># with error bars</span></span>
<span id="cb14-2"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: we start with the same code as above (lines 1--3), </span></span>
<span id="cb14-3"><a href=""></a><span class="co"># then add error bars (`geom_errorbar`)</span></span>
<span id="cb14-4"><a href=""></a><span class="fu">autoplot</span>(lasso_models) <span class="sc">+</span> </span>
<span id="cb14-5"><a href=""></a>  <span class="fu">scale_x_continuous</span>() <span class="sc">+</span> </span>
<span id="cb14-6"><a href=""></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(lambda)) <span class="sc">+</span> </span>
<span id="cb14-7"><a href=""></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> <span class="fu">collect_metrics</span>(lasso_models),</span>
<span id="cb14-8"><a href=""></a>                <span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">ymin =</span> mean <span class="sc">-</span> std_err, <span class="at">ymax =</span> mean <span class="sc">+</span> std_err), </span>
<span id="cb14-9"><a href=""></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use this to approximate the largest <span class="math inline">\(\lambda\)</span>, thus the most simple LASSO model, that produces a CV MAE that’s within 1 standard error of the best model (thus is not significantly worse). Check your approximation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a>parsimonious_penalty <span class="ot">&lt;-</span> lasso_models <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href=""></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"mae"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb15-3"><a href=""></a></span>
<span id="cb15-4"><a href=""></a>parsimonious_penalty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="a">
<li>Moving forward, we’ll use the parsimonious LASSO model. Simply report the tuning parameter <span class="math inline">\(\lambda\)</span> here. Just as a radio show needs to tell its audience where to tune the radio dial, it’s important to explicitly report <span class="math inline">\(\lambda\)</span> so that we and others can reproduce the model!</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li><span class="math inline">\(\lambda\)</span> close to 0</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a>best_penalty <span class="ot">&lt;-</span> lasso_models <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href=""></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mae"</span>)</span>
<span id="cb16-3"><a href=""></a></span>
<span id="cb16-4"><a href=""></a>best_penalty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  penalty .config              
    &lt;dbl&gt; &lt;chr&gt;                
1  0.0126 Preprocessor1_Model32</code></pre>
</div>
</div>
<ol start="2" type="a">
<li><span class="math inline">\(\lambda\)</span> around 0.2</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="co"># With error bars</span></span>
<span id="cb18-2"><a href=""></a><span class="fu">autoplot</span>(lasso_models) <span class="sc">+</span> </span>
<span id="cb18-3"><a href=""></a>  <span class="fu">scale_x_continuous</span>() <span class="sc">+</span> </span>
<span id="cb18-4"><a href=""></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(lambda)) <span class="sc">+</span> </span>
<span id="cb18-5"><a href=""></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> <span class="fu">collect_metrics</span>(lasso_models),</span>
<span id="cb18-6"><a href=""></a>                <span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">ymin =</span> mean <span class="sc">-</span> std_err, <span class="at">ymax =</span> mean <span class="sc">+</span> std_err), </span>
<span id="cb18-7"><a href=""></a>                <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="L06-lasso_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a>parsimonious_penalty <span class="ot">&lt;-</span> lasso_models <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href=""></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"mae"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb19-3"><a href=""></a></span>
<span id="cb19-4"><a href=""></a>parsimonious_penalty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  penalty .config              
    &lt;dbl&gt; &lt;chr&gt;                
1   0.200 Preprocessor1_Model44</code></pre>
</div>
</div>
<!-- note to self: there seems to have been an update to the .print functionality for lasso_models %>% select. 
we're not getting the same info as previously: https://bcheggeseth.github.io/253_spring_2024/lasso-shrinkageregularization.html
-->
<ol start="3" type="a">
<li>0.2</li>
</ol>
</details>
<p><br></p>
<blockquote>
<p><strong>PAUSE:</strong> Picking a range to try for <span class="math inline">\(\lambda\)</span></p>
<p>The range of values we tried for <span class="math inline">\(\lambda\)</span> had the following nice properties. If it didn’t, we should adjust our range (make it narrower or wider).</p>
<ul>
<li><p>Our range was wide enough.<br>
We observed the goldilocks effect. Further, the “best” and “parsimonious” <span class="math inline">\(\lambda\)</span> values were <em>not</em> at the edges of the range, suggesting there aren’t better <span class="math inline">\(\lambda\)</span> values outside our range.</p></li>
<li><p>Our range was narrow enough.<br>
We didn’t observe any loooooong flat lines in CV MAE, thus we narrowed in on the <span class="math inline">\(\lambda\)</span> values where the “action is happening”, i.e.&nbsp;where changing <span class="math inline">\(\lambda\)</span> impacts the model.</p></li>
</ul>
</blockquote>
<ol start="3" type="1">
<li><strong>Finalizing our LASSO model</strong></li>
</ol>
<p>Let’s <em>finalize</em> our parsimonious LASSO model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a>final_lasso <span class="ot">&lt;-</span> lasso_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href=""></a>  <span class="fu">finalize_workflow</span>(<span class="at">parameters =</span> parsimonious_penalty) <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href=""></a>  <span class="fu">fit</span>(<span class="at">data =</span> humans)</span>
<span id="cb21-4"><a href=""></a>    </span>
<span id="cb21-5"><a href=""></a>final_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb21-6"><a href=""></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li><p>How many and which predictors were <em>kept</em> in this model?</p></li>
<li><p>How do these compare to the 5-predictor model we identify using the backward stepwise selection algorithm with this subset of data: weight, abdomen, thigh, neck, chest</p></li>
</ol>
<!-- note to self: should this be weight, hip, forearm, thigh, chest instead? 
are we using different data than L05? -->
<ol start="3" type="a">
<li><p>Through shrinkage, the LASSO coefficients lose some contextual meaning, so we typically shouldn’t interpret them. Why don’t we care?! THINK: What is the goal of LASSO modeling?</p></li>
<li><p>The LASSO <code>tidy()</code> summary doesn’t report p-values for testing the “significance” of our predictors. Why don’t we care? (Name two reasons.)</p></li>
</ol>
<details>
<summary>
Solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a>final_lasso <span class="ot">&lt;-</span> lasso_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href=""></a>  <span class="fu">finalize_workflow</span>(<span class="at">parameters =</span> parsimonious_penalty) <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href=""></a>  <span class="fu">fit</span>(<span class="at">data =</span> humans)</span>
<span id="cb22-4"><a href=""></a></span>
<span id="cb22-5"><a href=""></a>final_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb22-6"><a href=""></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb22-7"><a href=""></a>  <span class="fu">filter</span>(estimate <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  term        estimate penalty
  &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;
1 (Intercept)  63.8      0.200
2 weight        0.0696   0.200
3 abdomen      -0.126    0.200
4 thigh        -0.0199   0.200
5 knee          0.156    0.200
6 ankle         0.0474   0.200</code></pre>
</div>
</div>
<ol type="a">
<li><p>5: weight, abdomen, thigh, knee, ankle</p></li>
<li><p>3 of the predictors are the same. LASSO includes knee (which is the most highly correlated with height in this dataset)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="fu">cor</span>(humans)[,<span class="st">'height'</span>] <span class="sc">%&gt;%</span> <span class="fu">sort</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       age    abdomen    forearm      thigh       neck      chest      wrist 
-0.1469746  0.1120756  0.1303829  0.2059575  0.2382709  0.2399610  0.2451834 
    biceps        hip      ankle     weight       knee     height 
 0.3173460  0.3470352  0.3628819  0.4440995  0.4441473  1.0000000 </code></pre>
</div>
</div>
<ol start="3" type="a">
<li><p>We’re using this model to give good predictions, not to explore / make inferences about relationships.</p></li>
<li><p>The remaining predictors are those that have significant predictive power in this linear regression model (thus we get conclusions like a hypothesis test without doing a test). Also, our goal is to build a good predictive model, not to do inference.</p></li>
</ol>
<!-- note to self: add something about post-selection inference? -->
</details>
<p><br></p>
<ol start="4" type="1">
<li><strong>LASSO vs LASSO</strong></li>
</ol>
<ol type="a">
<li>Our parsimonious LASSO selected only 5 of the 12 possible predictors. Out of curiosity, how many predictors would have remained if we had used the <code>best_penalty</code> value for <span class="math inline">\(\lambda\)</span>?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href=""></a>lasso_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href=""></a>  <span class="fu">finalize_workflow</span>(<span class="at">parameters =</span> ___) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href=""></a>  <span class="fu">fit</span>(<span class="at">data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href=""></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>Based on this example, do you think LASSO is a greedy algorithm? Are you “stuck” with your past locally optimal choices? Compare the predictors in this larger model with those in the smaller, parsimonious model.</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li>This would have 11 predictors.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href=""></a>lasso_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href=""></a>  <span class="fu">finalize_workflow</span>(<span class="at">parameters =</span> best_penalty) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href=""></a>  <span class="fu">fit</span>(<span class="at">data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb27-4"><a href=""></a>  <span class="fu">tidy</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href=""></a>  <span class="fu">filter</span>(estimate <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   term        estimate penalty
   &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept) 104.      0.0126
 2 age          -0.0208  0.0126
 3 weight        0.243   0.0126
 4 neck         -0.595   0.0126
 5 chest        -0.102   0.0126
 6 abdomen      -0.200   0.0126
 7 hip          -0.0491  0.0126
 8 thigh        -0.307   0.0126
 9 knee          0.180   0.0126
10 biceps       -0.145   0.0126
11 forearm      -0.0640  0.0126
12 wrist        -0.0864  0.0126</code></pre>
</div>
</div>
<ol start="2" type="a">
<li>ankle is not in this larger model but it is in the more parsimonious model. Therefore, the algorithm can’t be greedy. If it were greedy, then ankle would get removed for all smaller models.</li>
</ol>
</details>
<p><br></p>
<ol start="5" type="1">
<li><strong>LASSO vs least squares</strong></li>
</ol>
<p>Let’s compare our <code>final_lasso</code> model to the least squares model using all predictors:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href=""></a><span class="co"># Build the least squares model using recipes and workflows</span></span>
<span id="cb29-2"><a href=""></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb29-3"><a href=""></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-4"><a href=""></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb29-5"><a href=""></a></span>
<span id="cb29-6"><a href=""></a>ls_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href=""></a>  <span class="fu">add_model</span>(lm_spec) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href=""></a>  <span class="fu">add_recipe</span>(variable_recipe) </span>
<span id="cb29-9"><a href=""></a></span>
<span id="cb29-10"><a href=""></a>ls_model <span class="ot">&lt;-</span> ls_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb29-11"><a href=""></a>  <span class="fu">fit</span>(<span class="at">data =</span> humans) </span>
<span id="cb29-12"><a href=""></a></span>
<span id="cb29-13"><a href=""></a><span class="co"># examine coefficients</span></span>
<span id="cb29-14"><a href=""></a>ls_model <span class="sc">%&gt;%</span> </span>
<span id="cb29-15"><a href=""></a>  <span class="fu">tidy</span>()</span>
<span id="cb29-16"><a href=""></a></span>
<span id="cb29-17"><a href=""></a><span class="co"># get 10-fold CV MAE</span></span>
<span id="cb29-18"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">253</span>)</span>
<span id="cb29-19"><a href=""></a>ls_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb29-20"><a href=""></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb29-21"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(humans,<span class="at">v =</span> <span class="dv">10</span>),</span>
<span id="cb29-22"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae)</span>
<span id="cb29-23"><a href=""></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb29-24"><a href=""></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="a">
<li><p>Our <code>final_lasso</code> has 5 predictors and a CV MAE of 1.9 (calculated above). The <code>ls_model</code> has 12 predictors and a CV MAE of 1.8 (confirm). Comment.</p></li>
<li><p>Use both <code>final_lasso</code> and <code>ls_model</code> to predict the height of the new patient below. How do these compare? Does this <em>add to</em> or <em>calm</em> any fears you might have had about shrinking coefficients?!</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href=""></a>new_patient <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">50</span>, <span class="at">weight =</span> <span class="dv">200</span>, <span class="at">neck =</span> <span class="dv">40</span>, <span class="at">chest =</span> <span class="dv">115</span>, <span class="at">abdomen =</span> <span class="dv">105</span>, <span class="at">hip =</span> <span class="dv">100</span>, <span class="at">thigh =</span> <span class="dv">60</span>, <span class="at">knee =</span> <span class="dv">38</span>, <span class="at">ankle =</span> <span class="dv">23</span>, <span class="at">biceps =</span> <span class="dv">32</span>, <span class="at">forearm =</span> <span class="dv">29</span>, <span class="at">wrist =</span> <span class="dv">19</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href=""></a><span class="co"># LS prediction</span></span>
<span id="cb31-2"><a href=""></a>___ <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href=""></a><span class="fu">predict</span>(<span class="at">new_data =</span> ___)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href=""></a><span class="co"># LASSO prediction</span></span>
<span id="cb32-2"><a href=""></a>___ <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href=""></a><span class="fu">predict</span>(<span class="at">new_data =</span> ___)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="a">
<li>Which final model would you choose, the LASSO or least squares?</li>
</ol>
<details>
<summary>
Solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href=""></a><span class="co"># Build the LS model</span></span>
<span id="cb33-2"><a href=""></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href=""></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-4"><a href=""></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb33-5"><a href=""></a></span>
<span id="cb33-6"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: we created variable_recipe above</span></span>
<span id="cb33-7"><a href=""></a><span class="co"># here's what that looked like: </span></span>
<span id="cb33-8"><a href=""></a><span class="do">## variable_recipe &lt;- recipe(height ~ ., data = humans) %&gt;% </span></span>
<span id="cb33-9"><a href=""></a><span class="do">##   step_dummy(all_nominal_predictors())</span></span>
<span id="cb33-10"><a href=""></a></span>
<span id="cb33-11"><a href=""></a>ls_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href=""></a>  <span class="fu">add_model</span>(lm_spec) <span class="sc">%&gt;%</span></span>
<span id="cb33-13"><a href=""></a>  <span class="fu">add_recipe</span>(variable_recipe) </span>
<span id="cb33-14"><a href=""></a></span>
<span id="cb33-15"><a href=""></a>ls_model <span class="ot">&lt;-</span> ls_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb33-16"><a href=""></a>  <span class="fu">fit</span>(<span class="at">data =</span> humans) </span>
<span id="cb33-17"><a href=""></a></span>
<span id="cb33-18"><a href=""></a>ls_model <span class="sc">%&gt;%</span> </span>
<span id="cb33-19"><a href=""></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 5
   term        estimate std.error statistic     p.value
   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
 1 (Intercept) 110.       16.9       6.51   0.000000561
 2 age          -0.0234    0.0367   -0.637  0.529      
 3 weight        0.266     0.0573    4.64   0.0000810  
 4 neck         -0.671     0.335    -2.00   0.0556     
 5 chest        -0.119     0.131    -0.908  0.372      
 6 abdomen      -0.196     0.113    -1.73   0.0946     
 7 hip          -0.0978    0.189    -0.518  0.609      
 8 thigh        -0.313     0.163    -1.92   0.0661     
 9 knee          0.199     0.272     0.733  0.470      
10 ankle        -0.0262    0.449    -0.0583 0.954      
11 biceps       -0.168     0.200    -0.837  0.410      
12 forearm      -0.0770    0.144    -0.536  0.596      
13 wrist        -0.0962    0.647    -0.149  0.883      </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">253</span>)</span>
<span id="cb35-2"><a href=""></a>ls_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb35-3"><a href=""></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb35-4"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(humans,<span class="at">v =</span> <span class="dv">10</span>),</span>
<span id="cb35-5"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae)</span>
<span id="cb35-6"><a href=""></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb35-7"><a href=""></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  .metric .estimator  mean     n std_err .config             
  &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 mae     standard    1.81    10   0.212 Preprocessor1_Model1</code></pre>
</div>
</div>
<ol type="a">
<li>LASSO model is much simpler, and has only slightly worse predictions (on the scale of inches).</li>
<li>They’re very similar! Shrinking coefficients doesn’t mean our predictions are odd.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href=""></a>new_patient <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">age =</span> <span class="dv">50</span>, <span class="at">weight =</span> <span class="dv">200</span>, <span class="at">neck =</span> <span class="dv">40</span>, <span class="at">chest =</span> <span class="dv">115</span>, <span class="at">abdomen =</span> <span class="dv">105</span>, <span class="at">hip =</span> <span class="dv">100</span>, <span class="at">thigh =</span> <span class="dv">60</span>, <span class="at">knee =</span> <span class="dv">38</span>, <span class="at">ankle =</span> <span class="dv">23</span>, <span class="at">biceps =</span> <span class="dv">32</span>, <span class="at">forearm =</span> <span class="dv">29</span>, <span class="at">wrist =</span> <span class="dv">19</span>) </span>
<span id="cb37-2"><a href=""></a></span>
<span id="cb37-3"><a href=""></a><span class="co"># LS prediction</span></span>
<span id="cb37-4"><a href=""></a>ls_model <span class="sc">%&gt;%</span> </span>
<span id="cb37-5"><a href=""></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> new_patient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  .pred
  &lt;dbl&gt;
1  70.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href=""></a><span class="co"># LASSO prediction</span></span>
<span id="cb39-2"><a href=""></a>final_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb39-3"><a href=""></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> new_patient)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  .pred
  &lt;dbl&gt;
1  70.3</code></pre>
</div>
</div>
<ol start="3" type="a">
<li>LASSO</li>
</ol>
</details>
<p><br></p>
<p><strong>6. Visualizing LASSO shrinkage</strong></p>
<p>Finally, let’s zoom back out and compare the coefficients for all 50 LASSO models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href=""></a><span class="co"># Get output for each LASSO model</span></span>
<span id="cb41-2"><a href=""></a>all_lassos <span class="ot">&lt;-</span> final_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href=""></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href=""></a>  <span class="fu">pluck</span>(<span class="st">"fit"</span>)</span>
<span id="cb41-5"><a href=""></a>    </span>
<span id="cb41-6"><a href=""></a><span class="co"># Plot coefficient paths as a function of lambda</span></span>
<span id="cb41-7"><a href=""></a><span class="fu">plot</span>(all_lassos, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="L06-lasso_files/figure-html/unnamed-chunk-25-1.png" width="768"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href=""></a><span class="co"># Codebook for which variables the numbers correspond to</span></span>
<span id="cb42-2"><a href=""></a><span class="fu">rownames</span>(all_lassos<span class="sc">$</span>beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "age"     "weight"  "neck"    "chest"   "abdomen" "hip"     "thigh"  
 [8] "knee"    "ankle"   "biceps"  "forearm" "wrist"  </code></pre>
</div>
</div>
<p>There’s a <em>lot</em> of information in this plot!</p>
<ul>
<li><strong>lines</strong> = each line represents a different predictor. The small number to the left of each line indicates the predictor by its order in the <code>rownames()</code> list. Click “Zoom” to zoom in.</li>
<li><strong>x-axis</strong> = our range of <span class="math inline">\(\lambda\)</span> values, on the log scale</li>
<li><strong>y-axis</strong> = coefficient values at the corresponding <span class="math inline">\(\lambda\)</span><br>
</li>
<li><strong>numbers above the plot</strong> = how many predictors remain in the model with the corresponding <span class="math inline">\(\lambda\)</span></li>
</ul>
<p>We’ll process this information in the next 2 exercises.</p>
<p>If you’re curious, here is some code to recreate that plot using <code>ggplot</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href=""></a>lasso_coefs <span class="ot">&lt;-</span> all_lassos<span class="sc">$</span>beta  <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href=""></a>  <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span>  </span>
<span id="cb44-3"><a href=""></a>  <span class="fu">t</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href=""></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb44-5"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">lambda =</span> all_lassos<span class="sc">$</span>lambda ) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href=""></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>lambda, </span>
<span id="cb44-7"><a href=""></a>               <span class="at">names_to =</span> <span class="st">"term"</span>, </span>
<span id="cb44-8"><a href=""></a>               <span class="at">values_to =</span> <span class="st">"coef"</span>)</span>
<span id="cb44-9"><a href=""></a></span>
<span id="cb44-10"><a href=""></a>lasso_coefs <span class="sc">%&gt;%</span> <span class="fu">filter</span>(coef <span class="sc">!=</span> <span class="dv">0</span>, lambda <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  lambda term      coef
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
1   1.01 weight 0.00228
2   1.01 knee   0.0271 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href=""></a>lasso_coefs <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> coef, <span class="at">color =</span> term)) <span class="sc">+</span></span>
<span id="cb46-3"><a href=""></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb46-4"><a href=""></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> lasso_coefs <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lambda <span class="sc">==</span> <span class="fu">min</span>(lambda)), <span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.001</span>, <span class="at">label =</span> term), <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb46-5"><a href=""></a>  <span class="fu">scale_x_log10</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb46-6"><a href=""></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="L06-lasso_files/figure-html/unnamed-chunk-26-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="7" type="1">
<li><strong>plot: examining specific predictors</strong></li>
</ol>
<p>Answer the following questions for predictor 7.</p>
<ol type="a">
<li>Which predictor is this?</li>
<li>Approximate the coefficient in the LASSO with <span class="math inline">\(log(\lambda) \approx -5\)</span>.</li>
<li>At what <span class="math inline">\(log(\lambda)\)</span> does the coefficient start to significantly shrink?<br>
</li>
<li>At what <span class="math inline">\(log(\lambda)\)</span> does the predictor get dropped from the model?</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li>thigh</li>
<li>very roughly -0.32</li>
<li>roughly -3.5<br>
</li>
<li>roughly -1.8</li>
</ol>
</details>
<p><br></p>
<ol start="8" type="1">
<li><strong>plot: big picture</strong></li>
</ol>
<ol type="a">
<li>How does this plot reflect the LASSO shrinkage phenomenon?<br>
</li>
<li>What is one of the most “important” or “persistent” predictors?<br>
</li>
<li>What is one of the least persistent predictors?<br>
</li>
<li>Our parsimonious LASSO model had 5 predictors. How many predictors would remain if we had <em>minimized</em> the CV MAE using <span class="math inline">\(\lambda \approx 0.0126\)</span> (<span class="math inline">\(log(\lambda) = -4.4\)</span>)?</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li>coefficients are shrinking toward or to 0 as <span class="math inline">\(\lambda\)</span> increases</li>
<li>weight (variable 2), knee (variable 8)</li>
<li>lots of options here. look for the lines that drop to 0 sooner.</li>
<li>11</li>
</ol>
</details>
<p><br></p>
<p><br>
<br>
</p>
<ol start="9" type="1">
<li><strong>REVIEW: Model evaluation</strong></li>
</ol>
<p>Let’s finalize our LASSO analysis. Just as in least squares, it’s important to evaluate a LASSO model before applying it. We’ve already examined whether our LASSO model produces accurate predictions. Use a <strong>residual plot</strong> to determine if this model is <em>wrong</em>. NOTE: <code>augment()</code> gives predictions, but not residuals :/. You’ll need to calculate them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href=""></a><span class="co"># Note what augment() gives us</span></span>
<span id="cb47-2"><a href=""></a>final_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb47-3"><a href=""></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb47-4"><a href=""></a>  <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href=""></a><span class="co"># Now calculate and plot the residuals</span></span>
<span id="cb48-2"><a href=""></a>final_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href=""></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb48-4"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">.resid =</span> ___) <span class="sc">%&gt;%</span> </span>
<span id="cb48-5"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ___, <span class="at">y =</span> ___)) <span class="sc">+</span> </span>
<span id="cb48-6"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb48-7"><a href=""></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
Solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href=""></a><span class="co"># use augment to get predictions (.pred)</span></span>
<span id="cb49-2"><a href=""></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: we don't get the residuals (.resid) automatically</span></span>
<span id="cb49-3"><a href=""></a>final_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb49-4"><a href=""></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href=""></a>  <span class="fu">names</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] ".pred"   "age"     "weight"  "neck"    "chest"   "abdomen" "hip"    
 [8] "thigh"   "knee"    "ankle"   "biceps"  "forearm" "wrist"   "height" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href=""></a><span class="co"># Now calculate and plot the residuals</span></span>
<span id="cb51-2"><a href=""></a>final_lasso <span class="sc">%&gt;%</span> </span>
<span id="cb51-3"><a href=""></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">.resid =</span> height <span class="sc">-</span> .pred) <span class="sc">%&gt;%</span> <span class="co"># resid = observed - predicted</span></span>
<span id="cb51-5"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> .pred, <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb51-6"><a href=""></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb51-7"><a href=""></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb51-8"><a href=""></a>  <span class="fu">geom_smooth</span>(<span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure>
<p><img data-src="L06-lasso_files/figure-html/unnamed-chunk-30-1.png" width="672"></p>
</figure>
</div>
</div>
</div>
</details>
<p><br></p>
<ol start="10" type="1">
<li><strong>OPTIONAL: Practice on another dataset</strong>.</li>
</ol>
<p>The <code>Hitters</code> data in the <code>ISLR</code> package contains the salaries and performance measures for 322 Major League Baseball players. Use LASSO to determine the “best” predictive model of player <code>Salary</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href=""></a><span class="co"># Load the data</span></span>
<span id="cb52-2"><a href=""></a><span class="fu">library</span>(ISLR)</span>
<span id="cb52-3"><a href=""></a><span class="fu">data</span>(Hitters)</span>
<span id="cb52-4"><a href=""></a>Hitters <span class="ot">&lt;-</span> Hitters <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href=""></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Salary))</span>
<span id="cb52-6"><a href=""></a></span>
<span id="cb52-7"><a href=""></a><span class="co"># IN THE CONSOLE (not in the QMD): Examine codebook</span></span>
<span id="cb52-8"><a href=""></a><span class="co">#?Hitters  </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="11" type="1">
<li><strong>Reflection</strong><br>
This is the end of the (short!) Unit 2 on “Regression: Model Selection”! Let’s reflect on the technical content of this unit:
<ul>
<li>What was the main motivation / goal behind this unit?</li>
<li>For each of the following algorithms, describe the steps, pros, cons, and comparisons to least squares:
<ul>
<li>best subset selection</li>
<li>backward stepwise selection</li>
<li>LASSO</li>
</ul></li>
<li>In your own words, define the following: parsimonious models, greedy algorithms, Goldilocks problem.</li>
<li>Review the new tidymodels syntax from this unit. Identify key themes and patterns.</li>
</ul></li>
</ol>
</section></section>
<section>
<section id="wrap-up" class="title-slide slide level1 unnumbered center">
<h1>Wrap-Up</h1>

</section>
<section id="todays-material" class="slide level2 unnumbered">
<h2>Today’s Material</h2>
<ul>
<li>Finish the activity, check the solutions, and reach out with questions.</li>
<li>Review the R code reference section at the end of today’s notes and an optional R code tutorial video posted for today</li>
<li>If you’re curious, there’s an optional “deeper learning” section below that presents two other shrinkage algorithms we won’t cover in this course</li>
</ul>
</section>
<section id="upcoming-due-dates" class="slide level2 unnumbered">
<h2>Upcoming Due Dates</h2>
<ul>
<li>No checkpoint for next class!
<ul>
<li>See the <a href="schedule.html">schedule</a> for optional readings.</li>
<li>Your next checkpoint (CP6) will be due a week from today. It’s up on Moodle already if you’d like to get a head start on it.</li>
</ul></li>
<li>Due next Tuesday: HW2
<ul>
<li>You have everything you need to complete this assignment after today’s class</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="deeper-learning-very-optional" class="title-slide slide level1 unnumbered center">
<h1>Deeper learning (very optional)</h1>
<p>If you’re curious, consider how the LASSO connects to some other algorithms we won’t cover in STAT 253.</p>
</section>
<section id="ridge-regression" class="slide level2 unnumbered smaller">
<h2>Ridge Regression</h2>
<p>LASSO isn’t the only shrinkage &amp; regularization algorithm. An alternative is <strong>ridge regression</strong>. This algorithm also seeks to build a (predictive) linear regression model of <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[y = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \cdots + \hat{\beta}_p x_p + \varepsilon\]</span></p>
<p>It also does so by selecting coefficients which <strong>minimize a penalized residual sum of squares</strong>. HOWEVER, the ridge regression penalty is based upon the sum of <em>squared</em> coefficients instead of the sum of <em>absolute</em> coefficients:</p>
<p><span class="math display">\[RSS + \lambda \sum_{j=1}^p \hat{\beta}_j^2\]</span></p>
<p>This penalty regularizes / shrinks the coefficients. BUT, unlike the LASSO, ridge regression does NOT shrink coefficients to 0, thus cannot be used for variable selection. (Check out the ISLR text for a more rigorous, geometric explanation for why LASSO often shrinks coefficients to 0.)</p>
</section>
<section id="elastic-net" class="slide level2 unnumbered smaller">
<h2>Elastic Net</h2>
<p>The <strong>elastic net</strong> is yet another shrinkage &amp; regularization algorithm. It <em>combines</em> the penalties used in LASSO and ridge regression. This algorithm seeks to build a (predictive) linear regression model of <span class="math inline">\(y\)</span>:</p>
<p><span class="math display">\[y = \hat{\beta}_0 + \hat{\beta}_1 x_1 + \cdots + \hat{\beta}_p x_p + \varepsilon\]</span></p>
<p>by selecting coefficients which minimize the following penalized residual sum of squares:</p>
<p><span class="math display">\[RSS + \lambda_1 \sum_{j=1}^p \vert \hat{\beta}_j \vert + \lambda_2 \sum_{j=1}^p \hat{\beta}_j^2\]</span></p>
<p><strong>NOTE:</strong></p>
<ul>
<li>Elastic net depends upon <strong>two</strong> tuning parameters, <span class="math inline">\(\lambda_1\)</span> and <span class="math inline">\(\lambda_2\)</span>, thus is more complicated than the LASSO.</li>
<li>In cases when we have a group of correlated predictors, LASSO tends to select only one of these predictors. The elastic net does not.</li>
</ul>
</section>
<section id="bayesian-connections" class="slide level2 unnumbered smaller">
<h2>Bayesian Connections</h2>
<p>IF you have taken or will take <em>Bayesian statistics</em> (STAT 454), we can also write the LASSO as a Bayesian model. Specifically, LASSO estimates are equivalent to the posterior mode estimates of <span class="math inline">\(\beta_j\)</span>.</p>
<p><span class="math display">\[\begin{split}
Y_i | \beta_0,...\beta_k &amp; \sim N(\beta_0 + \beta_1X_1 + \cdots + \beta_p X_p, \sigma^2) \\
\beta_j &amp; \sim \text{ Laplace (double-exponential)}(0, f(\lambda)) \\
\sigma^2 &amp; \sim \text{ some prior} \\
\end{split}\]</span></p>
</section></section>
<section id="notes-r-code" class="title-slide slide level1 unnumbered center">
<h1>Notes: R Code</h1>
<p>Suppose we want to build a model of response variable <code>y</code> using <em>all</em> possible predictors in our <code>sample_data</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href=""></a><span class="co"># Load packages</span></span>
<span id="cb53-2"><a href=""></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<p><strong>Build the model for a range of tuning parameters</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href=""></a><span class="co"># STEP 1: LASSO model specification</span></span>
<span id="cb54-2"><a href=""></a>lasso_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href=""></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href=""></a>  <span class="fu">set_engine</span>(<span class="st">"glmnet"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb54-5"><a href=""></a>  <span class="fu">set_args</span>(<span class="at">mixture =</span> <span class="dv">1</span>, <span class="at">penalty =</span> <span class="fu">tune</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>STEP 1 notes:</p>
<ul>
<li>We use the <code>glmnet</code>, not <code>lm</code>, engine to build the LASSO.</li>
<li>The <code>glmnet</code> engine requires us to specify some arguments (<code>set_args</code>):
<ul>
<li><code>mixture = 1</code> indicates LASSO. Changing this would run a different regularization algorithm.</li>
<li><code>penalty = tune()</code> indicates that we don’t (yet) know an appropriate <span class="math inline">\(\lambda\)</span> penalty term. We need to tune it.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href=""></a><span class="co"># STEP 2: variable recipe</span></span>
<span id="cb55-2"><a href=""></a><span class="co"># (You can add pre-processing steps. We will discuss step_dummy() in the next class.)</span></span>
<span id="cb55-3"><a href=""></a>variable_recipe <span class="ot">&lt;-</span> <span class="fu">recipe</span>(y <span class="sc">~</span> ., <span class="at">data =</span> sample_data) <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href=""></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal_predictors</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href=""></a><span class="co"># STEP 3: workflow specification (model + recipe)</span></span>
<span id="cb56-2"><a href=""></a>lasso_workflow <span class="ot">&lt;-</span> <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href=""></a>  <span class="fu">add_recipe</span>(variable_recipe) <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href=""></a>  <span class="fu">add_model</span>(lasso_spec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href=""></a><span class="co"># STEP 4: Estimate multiple LASSO models using a range of possible lambda values</span></span>
<span id="cb57-2"><a href=""></a><span class="fu">set.seed</span>(___)</span>
<span id="cb57-3"><a href=""></a>lasso_models <span class="ot">&lt;-</span> lasso_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb57-4"><a href=""></a>  <span class="fu">tune_grid</span>(</span>
<span id="cb57-5"><a href=""></a>    <span class="at">grid =</span> <span class="fu">grid_regular</span>(<span class="fu">penalty</span>(<span class="at">range =</span> <span class="fu">c</span>(___, ___)), <span class="at">levels =</span> ___),</span>
<span id="cb57-6"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(sample_data, <span class="at">v =</span> ___),</span>
<span id="cb57-7"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae)</span>
<span id="cb57-8"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>STEP 4 notes:</p>
<ul>
<li>Since the CV process is random, we need to <code>set.seed(___)</code>.</li>
<li>We use <code>tune_grid()</code> instead of <code>fit()</code> since we have to build multiple LASSO models, each using a different tuning parameter.</li>
<li><code>grid</code> specifies the values of tuning parameter <span class="math inline">\(\lambda\)</span> that we want to try.
<ul>
<li><code>penalty(range = c(___, ___))</code> specifies a range of <span class="math inline">\(\lambda\)</span> values we want to try, on the log10 scale. You might start with <code>c(-5, 1)</code>, hence <span class="math inline">\(\lambda\)</span> from 0.00001 (<span class="math inline">\(10^(-5)\)</span>) to 10 (<span class="math inline">\(10^1\)</span>), and adjust from there.</li>
<li><code>levels</code> is the <em>number</em> of <span class="math inline">\(\lambda\)</span> values to try in that range, thus how many LASSO models to build.</li>
</ul></li>
<li><code>resamples</code> and <code>metrics</code> indicate that we want to calculate a CV MAE for each LASSO model.</li>
</ul>
<p><br>
<br>
</p>
<p><strong>Tuning <span class="math inline">\(\lambda\)</span></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href=""></a><span class="co"># Calculate CV MAE for each LASSO model</span></span>
<span id="cb58-2"><a href=""></a>lasso_models <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href=""></a>  <span class="fu">collect_metrics</span>()</span>
<span id="cb58-4"><a href=""></a></span>
<span id="cb58-5"><a href=""></a><span class="co"># Plot CV MAE (y-axis) for the LASSO model from each lambda (x-axis)</span></span>
<span id="cb58-6"><a href=""></a><span class="fu">autoplot</span>(lasso_models) <span class="sc">+</span> </span>
<span id="cb58-7"><a href=""></a>  <span class="fu">scale_x_log10</span>()           <span class="co"># plot lambda on log10 scale</span></span>
<span id="cb58-8"><a href=""></a><span class="fu">autoplot</span>(lasso_models) <span class="sc">+</span> </span>
<span id="cb58-9"><a href=""></a>  <span class="fu">scale_x_continuous</span>() <span class="sc">+</span>    <span class="co"># plot lambda on original scale</span></span>
<span id="cb58-10"><a href=""></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span>
<span id="cb58-11"><a href=""></a></span>
<span id="cb58-12"><a href=""></a><span class="co"># CV MAE plot with error bars (+/- 1 standard error)</span></span>
<span id="cb58-13"><a href=""></a><span class="co"># With error bars</span></span>
<span id="cb58-14"><a href=""></a><span class="fu">autoplot</span>(lasso_models) <span class="sc">+</span> </span>
<span id="cb58-15"><a href=""></a>  <span class="fu">scale_x_continuous</span>() <span class="sc">+</span> </span>
<span id="cb58-16"><a href=""></a>  <span class="fu">xlab</span>(<span class="fu">expression</span>(lambda)) <span class="sc">+</span> </span>
<span id="cb58-17"><a href=""></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> <span class="fu">collect_metrics</span>(lasso_models),</span>
<span id="cb58-18"><a href=""></a>                <span class="fu">aes</span>(<span class="at">x =</span> penalty, <span class="at">ymin =</span> mean <span class="sc">-</span> std_err, <span class="at">ymax =</span> mean <span class="sc">+</span> std_err), <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb58-19"><a href=""></a></span>
<span id="cb58-20"><a href=""></a><span class="co"># Identify lambda which produced the lowest ("best") CV MAE</span></span>
<span id="cb58-21"><a href=""></a>best_penalty <span class="ot">&lt;-</span> lasso_models <span class="sc">%&gt;%</span> </span>
<span id="cb58-22"><a href=""></a>  <span class="fu">select_best</span>(<span class="at">metric =</span> <span class="st">"mae"</span>)</span>
<span id="cb58-23"><a href=""></a>best_penalty</span>
<span id="cb58-24"><a href=""></a></span>
<span id="cb58-25"><a href=""></a><span class="co"># Identify the largest lambda (hence simplest LASSO) for which the CV MAE is</span></span>
<span id="cb58-26"><a href=""></a><span class="co"># larger but "roughly as good" (within one standard error of the lowest)</span></span>
<span id="cb58-27"><a href=""></a>parsimonious_penalty <span class="ot">&lt;-</span> lasso_models <span class="sc">%&gt;%</span> </span>
<span id="cb58-28"><a href=""></a>  <span class="fu">select_by_one_std_err</span>(<span class="at">metric =</span> <span class="st">"mae"</span>, <span class="fu">desc</span>(penalty))</span>
<span id="cb58-29"><a href=""></a>parsimonious_penalty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
</p>
<p><strong>Finalizing the “best” LASSO model</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href=""></a><span class="co"># parameters = final lambda value (best_penalty or parsimonious_penalty)</span></span>
<span id="cb59-2"><a href=""></a>final_lasso_model <span class="ot">&lt;-</span> lasso_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href=""></a>  <span class="fu">finalize_workflow</span>(<span class="at">parameters =</span> ___) <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href=""></a>  <span class="fu">fit</span>(<span class="at">data =</span> sample_data)</span>
<span id="cb59-5"><a href=""></a></span>
<span id="cb59-6"><a href=""></a><span class="co"># Check it out</span></span>
<span id="cb59-7"><a href=""></a>final_lasso_model <span class="sc">%&gt;%</span> </span>
<span id="cb59-8"><a href=""></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
<br>
</p>
<p><strong>Using the final LASSO model to make predictions</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href=""></a>final_lasso_model <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href=""></a>  <span class="fu">predict</span>(<span class="at">new_data =</span> SOME DATA FRAME W OBSERVATIONS ON EACH PREDICTOR)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
<br>
</p>
<p><strong>Visualizing shrinkage: comparing LASSO coefficients under each <span class="math inline">\(\lambda\)</span></strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href=""></a><span class="co"># Get output for each LASSO</span></span>
<span id="cb61-2"><a href=""></a>all_lassos <span class="ot">&lt;-</span> final_lasso_model <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href=""></a>  <span class="fu">extract_fit_parsnip</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-4"><a href=""></a>  <span class="fu">pluck</span>(<span class="st">"fit"</span>)</span>
<span id="cb61-5"><a href=""></a></span>
<span id="cb61-6"><a href=""></a><span class="co"># Plot coefficient paths as a function of lambda</span></span>
<span id="cb61-7"><a href=""></a><span class="fu">plot</span>(all_lassos, <span class="at">xvar =</span> <span class="st">"lambda"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="fu">rainbow</span>(<span class="dv">20</span>))</span>
<span id="cb61-8"><a href=""></a></span>
<span id="cb61-9"><a href=""></a><span class="co"># Codebook for which variables the numbers correspond to</span></span>
<span id="cb61-10"><a href=""></a><span class="fu">rownames</span>(all_lassos<span class="sc">$</span>beta)</span>
<span id="cb61-11"><a href=""></a></span>
<span id="cb61-12"><a href=""></a><span class="co"># e.g., What are variables 2 and 4?</span></span>
<span id="cb61-13"><a href=""></a><span class="fu">rownames</span>(all_lassos<span class="sc">$</span>beta)[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="quarto-auto-generated-content">
<p><img src="images/mac.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://kegrinde.github.io/stat253_coursenotes" class="uri">https://kegrinde.github.io/stat253_coursenotes</a></p>
</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="L06-lasso_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="L06-lasso_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="L06-lasso_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="L06-lasso_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'multiplex': {"secret":"17268622940987965790","id":"60081b5d413d4e0b","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>