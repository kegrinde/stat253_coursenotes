<!DOCTYPE html>
<html lang="en"><head>
<script src="L04-cross-validation_files/libs/clipboard/clipboard.min.js"></script>
<script src="L04-cross-validation_files/libs/quarto-html/tabby.min.js"></script>
<script src="L04-cross-validation_files/libs/quarto-html/popper.min.js"></script>
<script src="L04-cross-validation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="L04-cross-validation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="L04-cross-validation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="L04-cross-validation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="L04-cross-validation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.4.555">

  <title>Cross-Validation</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="L04-cross-validation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="L04-cross-validation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="L04-cross-validation_files/libs/revealjs/dist/theme/quarto.css">
  <link href="L04-cross-validation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="L04-cross-validation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="L04-cross-validation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="L04-cross-validation_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="L04-cross-validation_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="L04-cross-validation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Cross-Validation</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="settling-in" class="title-slide slide level1 unnumbered smaller center">
<h1>Settling In</h1>
<ul>
<li>Sit with the same group* as last class
<ul>
<li>If you missed class Tuesday, or if you’re in the *9:40 section, check with me for your (potentially) new group #!</li>
</ul></li>
<li>Introduce yourselves/check-in with each other, then discuss:
<ul>
<li>What has/hasn’t worked well for you in the past when it comes to working on in-class exercises in small groups?</li>
<li>What would you like to try, or avoid, with this group?</li>
</ul></li>
<li>Prepare to take notes (<a href="schedule.html">Schedule</a> &gt; 9/19 &gt; In Class &gt; QMD)</li>
<li>See the #announcements on <a href="https://macstat253.slack.com">Slack</a> about upcoming events</li>
</ul>
<!--
Announcements: 

::: incremental
-   Thursday at 11:15am - MSCS Coffee Break
    -   Smail Gallery
-   You should have been notified of a "Stat 253 Feedback" Google Sheet shared with you
    - Let me know if you didn't. This is where your individual feedback will be.
    - I'll send regular reminders to check this sheet.
-   Prepare to take notes.
    -   Locate the Rmd for today's *activity* in the Schedule of the course website (see bottom of slides for url).
    -   Save this Rmd in the "STAT 253 \> Notes" folder.
:::
-->
</section>

<section id="learning-goals" class="title-slide slide level1 unnumbered smaller center">
<h1>Learning Goals</h1>
<ul>
<li>Accurately describe all steps of cross-validation to estimate the test/out-of-sample version of a model evaluation metric</li>
<li>Explain what role CV has in a predictive modeling analysis and its connection to overfitting</li>
<li>Explain the pros/cons of higher vs.&nbsp;lower k in k-fold CV in terms of sample size and computing time</li>
<li>Implement cross-validation in R using the <code>tidymodels</code> package</li>
<li>Using these tools and concepts to:</li>
<li>Inform and justify data analysis and modeling process and the resulting conclusions with clear, organized, logical, and compelling details that adapt to the background, values, and motivations of the audience and context in which communication occurs</li>
</ul>
</section>

<section>
<section id="notes-cross-validation" class="title-slide slide level1 unnumbered center">
<h1>Notes: Cross-Validation</h1>

</section>
<section id="context-evaluating-regression-models" class="slide level2 unnumbered smaller scrollable">
<h2>Context: Evaluating Regression Models</h2>
<p>A reminder of our current context:</p>
<center>
<img src="images/MLdiagram1.jpg">
</center>
<ul>
<li><p><strong>world = supervised learning</strong><br>
We want to build a model some output variable <span class="math inline">\(y\)</span> by some predictors <span class="math inline">\(x\)</span>.</p></li>
<li><p><strong>task = regression</strong><br>
<span class="math inline">\(y\)</span> is quantitative</p></li>
<li><p><strong>model = linear regression model via least squares algorithm</strong><br>
We’ll assume that the relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> can be represented by</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_p x_p + \varepsilon\]</span></p></li>
</ul>
<p><br></p>
<p><strong>GOAL: model evaluation</strong></p>
<p>We want more <strong>honest</strong> metrics of prediction quality that</p>
<ol type="1">
<li>assess how well our model predicts <strong>new outcomes</strong>; and</li>
<li>help prevent <a href="L03-overfitting.html#overfitting"><strong>overfitting</strong></a>.</li>
</ol>
<p><br>
</p>
<p><img data-src="https://www.lucagiusti.it/wp-content/uploads/2022/10/overfitting-Trading-strategy.png" width="400"></p>
</section>
<section id="why-is-overfitting-so-bad" class="slide level2 unnumbered smaller">
<h2>Why is overfitting so bad?</h2>
<p>Not only can overfitting produce misleading models, it can have serious societal impacts. Examples:</p>
<ul>
<li><p><a href="https://www.reuters.com/article/us-amazon-com-jobs-automation-insight/amazon-scraps-secret-ai-recruiting-tool-that-showed-bias-against-women-idUSKCN1MK08G">A former Amazon algorithm</a> built to help sift through resumes was <em>overfit</em> to its current employees in leadership positions (who weren’t representative of the general population or candidate pool).</p></li>
<li><p>Facial recognition algorithms are often <em>overfit</em> to the people who build them (who are not broadly representative of society). As one example, this has led to <a href="https://www.nytimes.com/2019/07/08/us/detroit-facial-recognition-cameras.html">disproportionate bias in policing</a>. For more on this topic, you might check out <a href="https://www.youtube.com/watch?v=jZl55PsfZJQ">Coded Bias</a>, a documentary by Shalini Kantayya which features MIT Media Lab researcher Joy Buolamwini.</p></li>
<li><p>Polygenic risk scores (PRSs), which aim to predict a person’s risk of developing a particular disease/trait based on their genetics, are often <em>overfit</em> to the data on which they are built (which, historically, has exclusively—or at least primarily—included individuals of European ancestry). As a result, PRS predictions tend to be more accurate in European populations and new research suggests that their <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6563838/">continued use in clinical settings could exacerbate health disparities</a>.</p></li>
</ul>
</section>
<section id="k-fold-cross-validation" class="slide level2 unnumbered smaller">
<h2>k-fold Cross Validation</h2>
<p>We can use <strong>k-fold cross-validation</strong> to estimate the typical error in our model predictions for <em>new</em> data:</p>
<div>
<ul>
<li class="fragment">Divide the data into <span class="math inline">\(k\)</span> folds (or groups) of approximately equal size.<br>
</li>
<li class="fragment">Repeat the following procedures for each fold <span class="math inline">\(j = 1,2,...,k\)</span>:
<ul>
<li class="fragment">Remove fold <span class="math inline">\(j\)</span> from the data set.<br>
</li>
<li class="fragment">Fit a model using the data in the other <span class="math inline">\(k-1\)</span> folds (training).<br>
</li>
<li class="fragment">Use this model to predict the responses for the <span class="math inline">\(n_j\)</span> cases in fold <span class="math inline">\(j\)</span>: <span class="math inline">\(\hat{y}_1, ..., \hat{y}_{n_j}\)</span>.<br>
</li>
<li class="fragment">Calculate the MAE for fold <span class="math inline">\(j\)</span> (testing): <span class="math inline">\(\text{MAE}_j = \frac{1}{n_j}\sum_{i=1}^{n_j} |y_i - \hat{y}_i|\)</span>.</li>
</ul></li>
<li class="fragment">Combine this information into one measure of model quality: <span class="math display">\[\text{CV}_{(k)} = \frac{1}{k} \sum_{j=1}^k \text{MAE}_j\]</span></li>
</ul>
</div>
<center>
<img src="images/crossval.png">
</center>
</section></section>
<section>
<section id="small-group-discussion" class="title-slide slide level1 unnumbered center">
<h1>Small Group Discussion</h1>
<p>Algorithms and Tuning</p>
</section>
<section id="definitions" class="slide level2 unnumbered smaller scrollable">
<h2>Definitions</h2>
<ul>
<li><p><strong>algorithm</strong> = a step-by-step procedure for solving a problem (Merriam-Webster)</p></li>
<li><p><strong>tuning parameter</strong> = a <em>parameter</em> or <em>quantity</em> upon which an algorithm depends, that must be <em>selected</em> or <em>tuned</em> to “optimize” the algorithm</p></li>
</ul>
<p><img data-src="https://c1.wallpaperflare.com/preview/461/820/840/music-low-electric-bass-strings.jpg" width="250"><sup>1</sup> <img data-src="https://p1.pxfuel.com/preview/870/881/120/mixer-music-audio-studio-sound-studio-sound-mixer.jpg" width="250"></p>
<aside><ol class="aside-footnotes"><li id="fn1"><p>https://www.wallpaperflare.com/grayscale-photography-of-guitar-headstock-music-low-electric-bass-wallpaper-zzbyn</p></li></ol></aside></section>
<section id="prompts" class="slide level2 unnumbered smaller scrollable">
<h2>Prompts</h2>
<div class="fragment">
<ol type="1">
<li><strong>Algorithms</strong></li>
</ol>
<ol type="a">
<li><p>Why is <span class="math inline">\(k\)</span>-fold cross-validation an <em>algorithm</em>?</p></li>
<li><p>What is the <em>tuning parameter</em> of this algorithm and what values can this take?</p></li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li>Yes. It follows a list of steps to get to its goal.</li>
<li><span class="math inline">\(k\)</span>, the number of folds, is a tuning parameter. <span class="math inline">\(k\)</span> can be any integer from 1, 2, …, <span class="math inline">\(n\)</span> where <span class="math inline">\(n\)</span> is our sample size.</li>
</ol>
</details>
<p><br></p>
</div>
<div class="fragment">
<ol start="2" type="1">
<li><strong>Tuning the k-fold Cross-Validation algorithm</strong></li>
</ol>
<!-- bring deck of cards -->
<!-- 2/3 should be even cards and 1/3 should be odd -->
<!-- pass them out so that 2-fold cross-validation is bad. 1/2 of the class has more, but not all, of the odd cards -->
<!-- make students sit at 6 tables, if possible, to make 3-fold cv easier -->
<p>Let’s explore k-fold cross-validation with some personal experience. Our class has a representative sample of cards from a non-traditional population (no “face cards”, not equal numbers, etc). We want to use these to predict whether a new card will be odd or even (a classification task).</p>
<ol type="a">
<li>Based on <em>all</em> of our cards, do we predict the next card will be odd or even?</li>
<li>You’ve been split into 2 groups. Use 2-fold cross-validation to estimate the possible error of using <em>our</em> sample of cards to predict whether a <em>new</em> card will be odd or even. How’s this different than <em>validation</em>?</li>
<li>Repeat for 3-fold cross-validation. Why might this be better than 2-fold cross-validation?</li>
<li>Repeat for LOOCV, i.e.&nbsp;n-fold cross-validation where n is the number of students in this room. Why might this be worse than 3-fold cross-validation?</li>
<li>What value of k do you think practitioners typically use?</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li>Use the percentage of odd and percentage of even among the sample of cards to help you make a prediction.</li>
<li>We use both groups as training and testing, in turn.</li>
<li>We have a larger dataset to train our model on. We are less likely to get an unrepresentative set as our training data.</li>
<li>Prediction error for 1 person is highly variable.</li>
<li>In practice, <span class="math inline">\(k = 10\)</span> and <span class="math inline">\(k=7\)</span> are common choices for cross-validation. This has been shown to hit the ‘sweet spot’ between the extremes of <span class="math inline">\(k=n\)</span> (LOOCV) and <span class="math inline">\(k=2\)</span>.</li>
</ol>
<ul>
<li><span class="math inline">\(k=2\)</span> only utilizes 50% of the data for each training model, thus might result in overestimating the prediction error</li>
<li><span class="math inline">\(k=n\)</span> leave-one-out cross-validation (LOOCV) requires us to build <span class="math inline">\(n\)</span> training models, thus might be computationally expensive for larger sample sizes <span class="math inline">\(n\)</span>. Further, with only one data point in each test set, the training sets have a lot of overlap. This correlation among the training sets can make the ultimate corresponding estimate of prediction error less reliable.</li>
</ul>
</details>
<!-- \ -->
<!-- \ -->
<!-- \ -->
<!-- \ -->
<!-- **SPECIAL CASE: LEAVE ONE OUT CROSS-VALIDATION (LOOCV)** -->
<!-- LOOCV is a special case of k-fold cross-validation in which, in each iteration, we hold out **one** data point as a test case and use the other $n-1$ data points for training.  Thus LOOCV is equivalent to $k = n$ fold CV. In pictures: In the end, we fit $n$ training models (blue lines) and test each on one test car (red dots). -->
<!-- ```{r echo = FALSE} -->
<!-- library(ISLR) -->
<!-- data(Auto) -->
<!-- cars <- Auto -->
<!-- set.seed(2) -->
<!-- cars_rep <- cars %>%  -->
<!--     sample_n(size = 20, replace = FALSE)  -->
<!-- pred <- rep(0,20) -->
<!-- for(i in 1:20){ -->
<!--   train <- cars_rep[-i,] -->
<!--   test  <- cars_rep[i,] -->
<!--   pred[i] <- predict(lm(mpg ~ horsepower, train), newdata = test) -->
<!-- } -->
<!-- cars_rep <- cars_rep %>%  -->
<!--     mutate(prediction = pred) %>%  -->
<!--     rep_sample_n(reps = 20, size = 20, replace = FALSE) %>%  -->
<!--     group_by(replicate) %>%  -->
<!--     arrange(name) %>%  -->
<!--     mutate(test = (1:20 == replicate)) %>%  -->
<!--     mutate(replicate = as.factor(replicate)) -->
<!-- ``` -->
<!-- ```{r echo = FALSE} -->
<!-- train_sets <- cars_rep[cars_rep$test == FALSE, ] -->
<!-- test_sets  <- cars_rep[cars_rep$test == TRUE, ] -->
<!-- ``` -->
<!-- ```{r fig.width=4, fig.height=4, echo = FALSE, eval = FALSE} -->
<!-- ggplot(train_sets, aes(x = horsepower, y = mpg)) + -->
<!--     geom_point() +  -->
<!--     stat_smooth(method = "lm", aes(group = replicate), se=FALSE, fullrange = TRUE) +  -->
<!--     geom_point(data = test_sets, aes(x = horsepower, y = mpg), color = "red", size = 4) +  -->
<!--     geom_segment(data = test_sets, aes(x = horsepower, xend = horsepower, y = mpg, yend = prediction), color = "red") + -->
<!--     transition_states(replicate) -->
<!-- ``` -->
<!-- ```{r fig.width=4, fig.height=4, echo = FALSE} -->
<!-- ggplot(train_sets, aes(x = horsepower, y = mpg)) + -->
<!--     geom_point() +  -->
<!--     stat_smooth(method = "lm", aes(group = replicate), se=FALSE, fullrange = TRUE) +  -->
<!--     geom_point(data = test_sets, aes(x = horsepower, y = mpg), color = "red", size = 4) +  -->
<!--     geom_segment(data = test_sets, aes(x = horsepower, xend = horsepower, y = mpg, yend = prediction), color = "red")  -->
<!-- ``` -->
<!-- \ -->
<!-- \ -->
<!-- \ -->
<!-- \ -->
<!-- **SELECTING k** -->
<!-- In practice, $k = 10$ and $k=7$ are common choices for cross-validation.  This has been shown to hit the 'sweet spot' between the extremes of $k=n$ (LOOCV) and $k=2$.   -->
<!-- - $k=2$ only utilizes 50% of the data for each training model, thus might result in overestimating the prediction error -->
<!-- - $k=n$ leave-one-out cross-validation (LOOCV) requires us to build $n$ training models, thus might be computationally expensive for larger sample sizes $n$. Further, with only one data point in each test set, the training sets have a lot of overlap.  This correlation among the training sets can make the ultimate corresponding estimate of prediction error less reliable. -->
<!-- c. As a class, we'll discuss the **bias-variance trade-off** for CV.     -->
<!-- <!-- p183 -->
<!-- all the CV are estimates of the prediction error of model built using our sample data     -->
<!-- LOOCV uses data most similar to full data: little bias -->
<!-- but also folds are similar in data - covariance increases variability in LOOCV.  -->
<!-- "Since the mean of many highly correlated quantities has higher variance than does the mean of many quantities that are not as highly correlated, the test error estimate resulting from LOOCV tends to have higher variance than does the test error estimate resulting from k-fold CV."" -->
<!-- BUT the impact depends upon sample size, etc -->
<!-- see for loop at the end of the activity: LOOCV varies less from sample to sample -->
<p><br></p>
</div>
<div class="fragment">
<ol start="3" type="1">
<li><strong>R Code Preview</strong></li>
</ol>
<p>We’ve been doing a 2-step process to build <strong>linear regression models</strong> using the <strong>tidymodels</strong> package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a><span class="co"># STEP 1: model specification</span></span>
<span id="cb1-2"><a href=""></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href=""></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-4"><a href=""></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb1-5"><a href=""></a>  </span>
<span id="cb1-6"><a href=""></a><span class="co"># STEP 2: model estimation</span></span>
<span id="cb1-7"><a href=""></a>my_model <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> </span>
<span id="cb1-8"><a href=""></a>  <span class="fu">fit</span>(</span>
<span id="cb1-9"><a href=""></a>    y <span class="sc">~</span> x1 <span class="sc">+</span> x2,</span>
<span id="cb1-10"><a href=""></a>    <span class="at">data =</span> sample_data</span>
<span id="cb1-11"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For k-fold cross-validation, we can <em>tweak</em> STEP 2.</p>
<ul>
<li>Discuss the code below and why we need to set the seed.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="co"># k-fold cross-validation</span></span>
<span id="cb2-2"><a href=""></a><span class="fu">set.seed</span>(___)</span>
<span id="cb2-3"><a href=""></a>my_model_cv <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href=""></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb2-5"><a href=""></a>    y <span class="sc">~</span> x1 <span class="sc">+</span> x2, </span>
<span id="cb2-6"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(sample_data, <span class="at">v =</span> ___), </span>
<span id="cb2-7"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae, rsq)</span>
<span id="cb2-8"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
Solution
</summary>
The process of creating the folds is random, so we should set the seed to have reproducibility within our work.
</details>
</div>
</section></section>
<section>
<section id="notes-r-code" class="title-slide slide level1 unnumbered smaller center">
<h1>Notes: R code</h1>
<p>Suppose we wish to build and evaluate a linear regression model of <code>y</code> vs <code>x1</code> and <code>x2</code> using our <code>sample_data</code>.</p>
<p><strong>First, load the appropriate packages</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a><span class="co"># Load packages</span></span>
<span id="cb3-2"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-3"><a href=""></a><span class="fu">library</span>(tidymodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="obtain-k-fold-cross-validated-estimates-of-mae-and-r2" class="slide level2 unnumbered smaller">
<h2>Obtain k-fold cross-validated estimates of MAE and <span class="math inline">\(R^2\)</span></h2>
<p>(Review above for discussion of these steps.)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a><span class="co"># model specification</span></span>
<span id="cb4-2"><a href=""></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href=""></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href=""></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb4-5"><a href=""></a></span>
<span id="cb4-6"><a href=""></a><span class="co"># k-fold cross-validation</span></span>
<span id="cb4-7"><a href=""></a><span class="co"># For "v", put your number of folds k</span></span>
<span id="cb4-8"><a href=""></a><span class="fu">set.seed</span>(___)</span>
<span id="cb4-9"><a href=""></a>model_cv <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href=""></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb4-11"><a href=""></a>    y <span class="sc">~</span> x1 <span class="sc">+</span> x2,</span>
<span id="cb4-12"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(sample_data, <span class="at">v =</span> ___), </span>
<span id="cb4-13"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae, rsq)</span>
<span id="cb4-14"><a href=""></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="obtain-the-cross-validated-metrics" class="slide level2 unnumbered smaller">
<h2>Obtain the cross-validated metrics</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a>model_cv <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href=""></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-the-mae-and-r-squared-for-each-test-fold" class="slide level2 unnumbered smaller">
<h2>Get the MAE and R-squared for each test fold</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href=""></a><span class="co"># MAE for each test fold: Model 1</span></span>
<span id="cb6-2"><a href=""></a>model_cv <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href=""></a>  <span class="fu">unnest</span>(.metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="exercises" class="title-slide slide level1 unnumbered center">
<h1>Exercises</h1>

</section>
<section id="instructions" class="slide level2 unnumbered smaller">
<h2>Instructions</h2>
<ul>
<li>Go to the <a href="schedule.html">Course Schedule</a> and find the QMD template for today
<ul>
<li>Save this in your STAT 253 Notes folder, NOT your downloads!</li>
</ul></li>
<li>Work through the exercises implementing CV to compare two possible models predicting <code>height</code></li>
<li>Same directions as before:
<ul>
<li>Be kind to yourself/each other</li>
<li><strong>Collaborate</strong></li>
<li>DON’T edit starter code (i.e., code with blanks <code>___</code>). Instead, copy-paste into a new code chunk below and edit from there.</li>
</ul></li>
<li>Ask me questions as I move around the room</li>
</ul>
</section>
<section id="questions" class="slide level2 unnumbered smaller scrollable">
<h2>Questions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href=""></a><span class="co"># Load packages and data</span></span>
<span id="cb7-2"><a href=""></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-3"><a href=""></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb7-4"><a href=""></a>humans <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://kegrinde.github.io/stat253_coursenotes/data/bodyfat50.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href=""></a>  <span class="fu">filter</span>(ankle <span class="sc">&lt;</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href=""></a>  <span class="fu">rename</span>(<span class="at">body_fat =</span> fatSiri)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
<br>
</p>
<ol type="1">
<li><strong>Review: In-sample metrics</strong></li>
</ol>
<p>Use the <code>humans</code> data to build two separate models of <code>height</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href=""></a><span class="co"># STEP 1: model specification</span></span>
<span id="cb8-2"><a href=""></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">___</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href=""></a>  <span class="fu">set_mode</span>(___) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href=""></a>  <span class="fu">set_engine</span>(___)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href=""></a><span class="co"># STEP 2: model estimation</span></span>
<span id="cb9-2"><a href=""></a>model_1 <span class="ot">&lt;-</span> ___ <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href=""></a>  <span class="fu">___</span>(height <span class="sc">~</span> hip <span class="sc">+</span> weight <span class="sc">+</span> thigh <span class="sc">+</span> knee <span class="sc">+</span> ankle, <span class="at">data =</span> humans)</span>
<span id="cb9-4"><a href=""></a>model_2 <span class="ot">&lt;-</span> ___ <span class="sc">%&gt;%</span> </span>
<span id="cb9-5"><a href=""></a>  <span class="fu">___</span>(height <span class="sc">~</span> chest <span class="sc">*</span> age <span class="sc">*</span> weight <span class="sc">*</span> body_fat <span class="sc">+</span> abdomen <span class="sc">+</span> hip <span class="sc">+</span> thigh <span class="sc">+</span> knee <span class="sc">+</span> ankle <span class="sc">+</span> biceps <span class="sc">+</span> forearm <span class="sc">+</span> wrist, <span class="at">data =</span> humans)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate the <strong>in-sample</strong> R-squared for both models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href=""></a><span class="co"># IN-SAMPLE R^2 for model_1 = ???</span></span>
<span id="cb10-2"><a href=""></a>model_1 <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href=""></a>  <span class="fu">___</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href=""></a><span class="co"># IN-SAMPLE R^2 for model_2 = ???</span></span>
<span id="cb11-2"><a href=""></a>model_2 <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href=""></a>  <span class="fu">___</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calculate the <strong>in-sample</strong> MAE for both models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href=""></a><span class="co"># IN-SAMPLE MAE for model_1 = ???</span></span>
<span id="cb12-2"><a href=""></a>model_1 <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href=""></a>  <span class="fu">___</span>(<span class="at">new_data =</span> ___) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href=""></a>  <span class="fu">mae</span>(<span class="at">truth =</span> ___, <span class="at">estimate =</span> ___)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href=""></a><span class="co"># IN-SAMPLE MAE for model_2 = ???</span></span>
<span id="cb13-2"><a href=""></a>model_2 <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href=""></a>  <span class="fu">___</span>(<span class="at">new_data =</span> ___) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href=""></a>  <span class="fu">mae</span>(<span class="at">truth =</span> ___, <span class="at">estimate =</span> ___)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
Solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href=""></a><span class="co"># STEP 1: model specification</span></span>
<span id="cb14-2"><a href=""></a>lm_spec <span class="ot">&lt;-</span> <span class="fu">linear_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href=""></a>  <span class="fu">set_mode</span>(<span class="st">"regression"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href=""></a>  <span class="fu">set_engine</span>(<span class="st">"lm"</span>)</span>
<span id="cb14-5"><a href=""></a></span>
<span id="cb14-6"><a href=""></a><span class="co"># STEP 2: model estimation</span></span>
<span id="cb14-7"><a href=""></a>model_1 <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href=""></a>  <span class="fu">fit</span>(height <span class="sc">~</span> hip <span class="sc">+</span> weight <span class="sc">+</span> thigh <span class="sc">+</span> knee <span class="sc">+</span> ankle, <span class="at">data =</span> humans)</span>
<span id="cb14-9"><a href=""></a>model_2 <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> </span>
<span id="cb14-10"><a href=""></a>  <span class="fu">fit</span>(height <span class="sc">~</span> chest <span class="sc">*</span> age <span class="sc">*</span> weight <span class="sc">*</span> body_fat <span class="sc">+</span> abdomen <span class="sc">+</span> hip <span class="sc">+</span> thigh <span class="sc">+</span> knee <span class="sc">+</span> ankle <span class="sc">+</span> biceps <span class="sc">+</span> forearm <span class="sc">+</span> wrist, <span class="at">data =</span> humans)</span>
<span id="cb14-11"><a href=""></a></span>
<span id="cb14-12"><a href=""></a><span class="co"># IN-SAMPLE R^2 for model_1 = 0.40</span></span>
<span id="cb14-13"><a href=""></a>model_1 <span class="sc">%&gt;%</span> </span>
<span id="cb14-14"><a href=""></a>  <span class="fu">glance</span>()</span>
<span id="cb14-15"><a href=""></a></span>
<span id="cb14-16"><a href=""></a><span class="co"># IN-SAMPLE R^2 for model_2 = 0.87</span></span>
<span id="cb14-17"><a href=""></a>model_2 <span class="sc">%&gt;%</span> </span>
<span id="cb14-18"><a href=""></a>  <span class="fu">glance</span>()</span>
<span id="cb14-19"><a href=""></a></span>
<span id="cb14-20"><a href=""></a><span class="co"># IN-SAMPLE MAE for model_1 = 1.55</span></span>
<span id="cb14-21"><a href=""></a>model_1 <span class="sc">%&gt;%</span> </span>
<span id="cb14-22"><a href=""></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb14-23"><a href=""></a>  <span class="fu">mae</span>(<span class="at">truth =</span> height, <span class="at">estimate =</span> .pred)</span>
<span id="cb14-24"><a href=""></a></span>
<span id="cb14-25"><a href=""></a><span class="co"># IN-SAMPLE MAE for model_2 = 0.64</span></span>
<span id="cb14-26"><a href=""></a>model_2 <span class="sc">%&gt;%</span> </span>
<span id="cb14-27"><a href=""></a>  <span class="fu">augment</span>(<span class="at">new_data =</span> humans) <span class="sc">%&gt;%</span> </span>
<span id="cb14-28"><a href=""></a>  <span class="fu">mae</span>(<span class="at">truth =</span> height, <span class="at">estimate =</span> .pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p><br></p>
<ol start="2" type="1">
<li><strong>In-sample model comparison</strong><br>
Which model seems “better” by the in-sample metrics you calculated above? Any concerns about either of these models?</li>
</ol>
<details>
<summary>
Solution
</summary>
The in-sample metrics are better for <code>model_2</code>, but from experience in our previous class, we should expect this to be overfit.
</details>
<p><br></p>
<ol start="3" type="1">
<li><p><strong>10-fold CV</strong><br>
Complete the code to run 10-fold cross-validation for our two models.</p>
<p><code>model_1</code>: <code>height ~ hip + weight</code><br>
<code>model_2</code>: <code>height ~ chest * age * weight * body_fat + abdomen + hip + thigh + knee + ankle + biceps + forearm + wrist</code></p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href=""></a><span class="co"># 10-fold cross-validation for model_1</span></span>
<span id="cb15-2"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">253</span>)</span>
<span id="cb15-3"><a href=""></a>model_1_cv <span class="ot">&lt;-</span> ___ <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href=""></a>  <span class="fu">___</span>(</span>
<span id="cb15-5"><a href=""></a>    ___,</span>
<span id="cb15-6"><a href=""></a>    <span class="at">___ =</span> <span class="fu">vfold_cv</span>(___, <span class="at">v =</span> ___), </span>
<span id="cb15-7"><a href=""></a>    <span class="at">___ =</span> <span class="fu">metric_set</span>(mae, rsq)</span>
<span id="cb15-8"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href=""></a><span class="co"># 10-fold cross-validation for model_2</span></span>
<span id="cb16-2"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">253</span>)</span>
<span id="cb16-3"><a href=""></a>model_2_cv <span class="ot">&lt;-</span> ___ <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href=""></a>  <span class="fu">___</span>(</span>
<span id="cb16-5"><a href=""></a>    ___,</span>
<span id="cb16-6"><a href=""></a>    <span class="at">___ =</span> <span class="fu">vfold_cv</span>(___, <span class="at">v =</span> ___), </span>
<span id="cb16-7"><a href=""></a>    <span class="at">___ =</span> <span class="fu">metric_set</span>(mae, rsq)</span>
<span id="cb16-8"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
Solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href=""></a><span class="co"># 10-fold cross-validation for model_1</span></span>
<span id="cb17-2"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">253</span>)</span>
<span id="cb17-3"><a href=""></a>model_1_cv <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href=""></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb17-5"><a href=""></a>    height <span class="sc">~</span> hip <span class="sc">+</span> weight <span class="sc">+</span> thigh <span class="sc">+</span> knee <span class="sc">+</span> ankle,</span>
<span id="cb17-6"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(humans, <span class="at">v =</span> <span class="dv">10</span>), </span>
<span id="cb17-7"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae, rsq)</span>
<span id="cb17-8"><a href=""></a>  )</span>
<span id="cb17-9"><a href=""></a></span>
<span id="cb17-10"><a href=""></a><span class="co"># STEP 2: 10-fold cross-validation for model_2</span></span>
<span id="cb17-11"><a href=""></a><span class="fu">set.seed</span>(<span class="dv">253</span>)</span>
<span id="cb17-12"><a href=""></a>model_2_cv <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> </span>
<span id="cb17-13"><a href=""></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb17-14"><a href=""></a>    height <span class="sc">~</span> chest <span class="sc">*</span> age <span class="sc">*</span> weight <span class="sc">*</span> body_fat <span class="sc">+</span> abdomen <span class="sc">+</span> hip <span class="sc">+</span> thigh <span class="sc">+</span> knee <span class="sc">+</span> ankle <span class="sc">+</span> biceps <span class="sc">+</span> forearm <span class="sc">+</span> wrist,</span>
<span id="cb17-15"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(humans, <span class="at">v =</span> <span class="dv">10</span>), </span>
<span id="cb17-16"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae, rsq)</span>
<span id="cb17-17"><a href=""></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p><br></p>
<ol start="4" type="1">
<li><strong>Calculating the CV MAE</strong></li>
</ol>
<ol type="a">
<li>Use <code>collect_metrics()</code> to obtain the cross-validated MAE and <span class="math inline">\(R^2\)</span> for both models.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href=""></a><span class="co"># HINT</span></span>
<span id="cb18-2"><a href=""></a>___ <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href=""></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>Interpret the cross-validated MAE <em>and</em> <span class="math inline">\(R^2\)</span> for <code>model_1</code>.</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href=""></a><span class="co"># model_1</span></span>
<span id="cb19-2"><a href=""></a><span class="co"># CV MAE = 1.87, CV R-squared = 0.41</span></span>
<span id="cb19-3"><a href=""></a>model_1_cv <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href=""></a>  <span class="fu">collect_metrics</span>()</span>
<span id="cb19-5"><a href=""></a></span>
<span id="cb19-6"><a href=""></a><span class="co"># model_2</span></span>
<span id="cb19-7"><a href=""></a><span class="co"># CV MAE = 2.47, CV R-squared = 0.53</span></span>
<span id="cb19-8"><a href=""></a>model_2_cv <span class="sc">%&gt;%</span> </span>
<span id="cb19-9"><a href=""></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>We expect our first model to explain roughly 40% of variability in height among new adults, and to produce predictions of height that are off by 1.9 inches on average.</li>
</ol>
</details>
<p><br></p>
<ol start="5" type="1">
<li><strong>Details: fold-by-fold results</strong><br>
<code>collect_metrics()</code> gave the final CV MAE, or the average MAE across all 10 test folds. <code>unnest(.metrics)</code> provides the MAE from <em>each</em> test fold.</li>
</ol>
<ol type="a">
<li>Obtain the fold-by-fold results for the <code>model_1</code> cross-validation procedure using <code>unnest(.metrics)</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href=""></a><span class="co"># HINT</span></span>
<span id="cb20-2"><a href=""></a>___ <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href=""></a>  <span class="fu">unnest</span>(.metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>Which fold had the worst average prediction error and what was it?</li>
<li>Recall that <code>collect_metrics()</code> reported a final CV MAE of 1.87 for <code>model_1</code>. Confirm this calculation by wrangling the fold-by-fold results from part a.</li>
</ol>
<details>
<summary>
Solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href=""></a><span class="co"># a. model_1 MAE for each test fold</span></span>
<span id="cb21-2"><a href=""></a>model_1_cv <span class="sc">%&gt;%</span> </span>
<span id="cb21-3"><a href=""></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href=""></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"mae"</span>)</span>
<span id="cb21-5"><a href=""></a></span>
<span id="cb21-6"><a href=""></a><span class="co"># b. fold 3 had the worst error (2.55)</span></span>
<span id="cb21-7"><a href=""></a></span>
<span id="cb21-8"><a href=""></a><span class="co"># c. use these metrics to confirm the 1.87 CV MAE for model_1</span></span>
<span id="cb21-9"><a href=""></a>model_1_cv <span class="sc">%&gt;%</span> </span>
<span id="cb21-10"><a href=""></a>  <span class="fu">unnest</span>(.metrics) <span class="sc">%&gt;%</span> </span>
<span id="cb21-11"><a href=""></a>  <span class="fu">filter</span>(.metric <span class="sc">==</span> <span class="st">"mae"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-12"><a href=""></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(.estimate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p><br></p>
<p><br>
<br>
</p>
<ol start="6" type="1">
<li><p><strong>Comparing models</strong><br>
The table below summarizes the in-sample and 10-fold CV MAE for both models.</p>
<p><br>
</p>
<table class="caption-top">
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">IN-SAMPLE MAE</th>
<th style="text-align: right;">10-fold CV MAE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>model_1</code></td>
<td style="text-align: right;">1.55</td>
<td style="text-align: right;">1.87</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>model_2</code></td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">2.47</td>
</tr>
</tbody>
</table>
<p><br>
</p></li>
</ol>
<ol type="a">
<li>Based on the in-sample MAE alone, which model appears better?<br>
</li>
<li>Based on the CV MAE alone, which model appears better?<br>
</li>
<li>Based on all of these results, which model would you pick?</li>
<li>Do the in-sample and CV MAE suggest that <code>model_1</code> is overfit to our <code>humans</code> sample data? What about <code>model_2</code>?</li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li><code>model_2</code></li>
<li><code>model_1</code></li>
<li><code>model_1</code> – <code>model_2</code> produces bad predictions for new adults</li>
<li><code>model_1</code> is <em>NOT</em> overfit – its predictions of height for new adults seem roughly as accurate as the predictions for the adults in our sample. <code>model_2</code> <em>IS</em> overfit – its predictions of height for new adults are worse than the predictions for the adults in our sample.</li>
</ol>
</details>
<p><br></p>
<ol start="7" type="1">
<li><strong>LOOCV</strong>
<ol type="a">
<li>Reconsider <code>model_1</code>. Instead of estimating its prediction accuracy using the 10-fold CV MAE, use the LOOCV MAE. THINK: How many people are in our <code>humans</code> sample?</li>
<li>How does the LOOCV MAE compare to the 10-fold CV MAE of 1.87? NOTE: These are just two different <em>approaches</em> to estimating the same thing: the typical prediction error when applying our model to new data. Thus we should expect them to be similar.<br>
</li>
<li>Explain why we technically don’t <em>need</em> to <code>set.seed()</code> for the LOOCV algorithm.</li>
</ol></li>
</ol>
<details>
<summary>
Solution
</summary>
<ol type="a">
<li>There are 40 people in our sample, thus LOOCV is equivalent to 40-fold CV:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href=""></a><span class="fu">nrow</span>(humans)</span>
<span id="cb22-2"><a href=""></a>model_1_loocv <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href=""></a>  <span class="fu">fit_resamples</span>(</span>
<span id="cb22-4"><a href=""></a>    height <span class="sc">~</span> hip <span class="sc">+</span> weight <span class="sc">+</span> thigh <span class="sc">+</span> knee <span class="sc">+</span> ankle,</span>
<span id="cb22-5"><a href=""></a>    <span class="at">resamples =</span> <span class="fu">vfold_cv</span>(humans, <span class="at">v =</span> <span class="fu">nrow</span>(humans)), </span>
<span id="cb22-6"><a href=""></a>    <span class="at">metrics =</span> <span class="fu">metric_set</span>(mae)</span>
<span id="cb22-7"><a href=""></a>  )</span>
<span id="cb22-8"><a href=""></a>    </span>
<span id="cb22-9"><a href=""></a>model_1_loocv <span class="sc">%&gt;%</span> </span>
<span id="cb22-10"><a href=""></a>  <span class="fu">collect_metrics</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>The LOOCV MAE (1.82) is very similar to the 10-fold CV MAE (1.87).</li>
<li>There’s no randomness in the test folds. Each test fold is a single person.</li>
</ol>
</details>
<p><br></p>
<ol start="8" type="1">
<li><strong>Data drill</strong></li>
</ol>
<ol type="a">
<li>Calculate the average height of people under 40 years old vs people 40+ years old.</li>
<li>Plot height vs age among our subjects that are 30+ years old.</li>
<li>Fix this code:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href=""></a>model_3<span class="ot">&lt;-</span>lm_spec<span class="sc">%&gt;%</span><span class="fu">fit</span>(height<span class="sc">~</span>age,<span class="at">data=</span>humans)</span>
<span id="cb23-2"><a href=""></a>model_3<span class="sc">%&gt;%</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<details>
<summary>
Solution
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href=""></a><span class="co"># a (one of many solutions)</span></span>
<span id="cb24-2"><a href=""></a>humans <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href=""></a>  <span class="fu">mutate</span>(<span class="at">younger_older =</span> age <span class="sc">&lt;</span> <span class="dv">40</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href=""></a>  <span class="fu">group_by</span>(younger_older) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href=""></a>  <span class="fu">summarize</span>(<span class="fu">mean</span>(height))</span>
<span id="cb24-6"><a href=""></a></span>
<span id="cb24-7"><a href=""></a><span class="co"># b</span></span>
<span id="cb24-8"><a href=""></a>humans <span class="sc">%&gt;%</span> </span>
<span id="cb24-9"><a href=""></a>  <span class="fu">filter</span>(age <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-10"><a href=""></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> height)) <span class="sc">+</span> </span>
<span id="cb24-11"><a href=""></a>  <span class="fu">geom_point</span>()</span>
<span id="cb24-12"><a href=""></a></span>
<span id="cb24-13"><a href=""></a><span class="co"># c</span></span>
<span id="cb24-14"><a href=""></a>model_3 <span class="ot">&lt;-</span> lm_spec <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href=""></a>  <span class="fu">fit</span>(height <span class="sc">~</span> age, <span class="at">data =</span> humans)</span>
<span id="cb24-16"><a href=""></a>model_3 <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href=""></a>  <span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p><br></p>
<ol start="9" type="1">
<li><p><strong>Reflection: Part 1</strong><br>
The “regular” exercises are over but class is not done! Your group should agree to either work on HW1 or the remaining reflection questions.</p>
<p>This is the end of Unit 1 on “Regression: Model Evaluation”! Let’s reflect on the technical content of this unit:</p></li>
</ol>
<ul>
<li>What was the main motivation / goal behind this unit?</li>
<li>What are the four main questions that were important to this unit?</li>
<li>For each of the following tools, describe how they work and what questions they help us address:
<ul>
<li>R-squared</li>
<li>residual plots</li>
<li>out-of-sample MAE</li>
<li>in-sample MAE</li>
<li>validation</li>
<li>cross-validation</li>
</ul></li>
<li>In your own words, define the following:
<ul>
<li>overfitting</li>
<li>algorithm</li>
<li>tuning parameter</li>
</ul></li>
<li>Review the new <code>tidymodels</code> syntax from this unit. Identify key themes and patterns.</li>
</ul>
<!--
I encourage you to make a copy of this [document](https://docs.google.com/presentation/d/1Kto9AzJTb6GB4VzmkTl1F1ICzRRaQ4Ib5EVtpjIiyUY/edit?usp=sharing) and add notes/thoughts after this Unit 1. 
-->
<p><br></p>
<ol start="10" type="1">
<li><p><strong>Reflection: Part 2</strong><br>
The reflection above addresses your understanding of/progress toward our course <strong>learning goals</strong>. Consider the other components that have helped you worked toward this learning throughout Unit 1.</p>
<ol type="a">
<li><p>With respect to <strong>collaboration</strong>, reflect upon your strengths and what you might change in the next unit:</p>
<ul>
<li>How actively did you contribute to group discussions?</li>
<li>How actively did you include all other group members in discussion?</li>
<li>In what ways did you (or did you not) help create a space where others feel comfortable making mistakes &amp; sharing their ideas?</li>
</ul></li>
<li><p>With respect to <strong>engagement</strong>, reflect upon your strengths and what you might change the next unit:</p>
<ul>
<li>Did you regularly attend, be on time for, &amp; stay for the full class sessions?</li>
<li>Have you not missed more than 3 in-person class sessions?</li>
<li>Were you actively present during class (eg: not on your phone, not working on other courses, etc)?</li>
<li>Did you stay updated on Slack?</li>
<li>When you had questions, did you ask them on Slack or in OH?</li>
</ul></li>
<li><p>With respect to <strong>preparation</strong>, how many of checkpoints 1–3 did you complete and pass?</p></li>
<li><p>With respect to <strong>exploration</strong>, did you complete and pass HW0? Are you on track to complete and pass HW1?</p></li>
</ol></li>
</ol>
<p><strong>Done!</strong></p>
<ul>
<li>Knit/render your notes.</li>
<li>Check the solutions in the online manual.</li>
<li>Check out the wrap-up steps below.</li>
<li>If you finish all that during class, work on your homework!</li>
</ul>
<!-- ## Deep learning -->
<!-- If you finish the exercises above, keep learning!  Choose your own adventure below.  Learning requires a growth mindset and curiosity -- it doesn't stop with the completion of tasks (eg: the exercises above). -->
<!-- \ -->
<!-- \ -->
<!-- **OPTIONAL EXERCISE 2: ANIMATIONS**     -->
<!-- Animations, are handy tools. For example, an animation might help us better connect to the concept of LOOCV. If you're curious how to do this, you'll need to install the `gganimate`, `infer`, and `devtools` packages **IN YOUR CONSOLE**: -->
<!-- ```{r eval = FALSE} -->
<!-- install.packages("devtools") -->
<!-- install.packages("infer") -->
<!-- devtools::install_github('thomasp85/gganimate') -->
<!-- ``` -->
<!-- In your Rmd, load these packages: -->
<!-- ```{r eval = FALSE} -->
<!-- library(gganimate) -->
<!-- library(infer) -->
<!-- ``` -->
<!-- You can find a bunch of animation examples [here](https://github.com/thomasp85/gganimate) or recreate the LOOCV animation from above using the following code: -->
<!-- ```{r eval = FALSE} -->
<!-- # Take a sample of 20 cars -->
<!-- # No need to pick through the code! -->
<!-- set.seed(2) -->
<!-- cars_rep <- cars %>%  -->
<!--   sample_n(size = 20, replace = FALSE) %>%  -->
<!--   rep_sample_n(reps = 20, size = 20, replace = FALSE) %>%  -->
<!--   group_by(replicate) %>%  -->
<!--   arrange(name) %>%  -->
<!--   mutate(test = (1:20 == replicate)) -->
<!-- train_sets <- cars_rep %>% filter(test == FALSE) -->
<!-- test_sets  <- cars_rep %>% filter(test == TRUE) -->
<!-- # This is the fun animation part -->
<!-- ggplot(train_sets, aes(x = horsepower, y = mpg)) + -->
<!--   geom_point() +  -->
<!--   stat_smooth(method = "lm", aes(group = replicate), se=FALSE, fullrange = TRUE) +  -->
<!--   geom_point(data = test_sets, aes(x = horsepower, y = mpg), color = "red", size = 4) +  -->
<!--   transition_states(replicate) -->
<!-- ``` -->
<!-- \ -->
<!-- \ -->
<!-- \ -->
<!-- \ -->
<!-- **OPTIONAL EXERCISE 3: FOR LOOPS** -->
<!-- We can calculate LOOCV using a *for loop* approach.  If you've taken some CS classes, this will be a familiar concept.  If you haven't, first of all don't worry -- it won't be a requirement in this class.  However, it might be fun to learn!  Try to pick through some hints online to fill in the following code to calculate the LOOCV error (as calculated by MAE) for the quadratic model of `mpg`. -->
<!-- ```{r eval = FALSE} -->
<!-- # Initialize the for loop -->
<!-- # Run the for loop -->
<!-- for(i in 1:nrow(cars)){ -->
<!--     # Set up the training data & test case -->
<!--     # Fit model using the training data -->
<!--     # Use training model to make a prediction for test case & calculate the residual -->
<!--     # Store the MAE for the test case -->
<!-- } -->
<!-- ``` -->
<!-- **HINT:** -->
<!-- <div class = "solution">   -->
<!-- ```{r eval = FALSE} -->
<!-- # Initialize the for loop -->
<!-- test_MAE <- rep(0, nrow(cars)) -->
<!-- # Run the for loop -->
<!-- for(i in 1:nrow(cars)){ -->
<!--     # Set up the training data & test case -->
<!--     train <- cars[-i,] -->
<!--     test  <- cars[i,] -->
<!--     # Fit model using the training data -->
<!--     train_mod <- lm(mpg ~ poly(horsepower,2), ___) -->
<!--     # Use training model to make a prediction for test case & calculate the residual -->
<!--     test_predicted <- predict(___, newdata = ___)   -->
<!--     test_residual  <- ___ -->
<!--     # Store the MAE for the test case -->
<!--     test_MAE[i] <- ___ -->
<!-- } -->
<!-- ``` -->
<!-- </div> -->
<!-- \ -->
<!-- **A solution:** -->
<!-- <div class = "solution">   -->
<!-- ```{r eval = FALSE} -->
<!-- # Initialize the for loop -->
<!-- test_MAE <- rep(0, nrow(cars)) -->
<!-- # Run the for loop -->
<!-- for(i in 1:nrow(cars)){ -->
<!--     # Set up the training data & test case -->
<!--     train <- cars[-i, ] -->
<!--     test  <- cars[i, ] -->
<!--     # Fit model using the training data -->
<!--     train_mod <- lm(mpg ~ poly(horsepower,2), train) -->
<!--     # Use training model to make a prediction for test case & calculate the residual -->
<!--     test_predicted <- predict(train_mod, newdata = test)   -->
<!--     test_residual  <- test$mpg - test_predicted -->
<!--     # Store the MAE for the test case -->
<!--     test_MAE[i] <- sqrt(test_residual^2) -->
<!-- } -->
<!-- mean(test_MAE) -->
<!-- ``` -->
<!-- </div> -->
</section></section>
<section>
<section id="wrap-up" class="title-slide slide level1 unnumbered smaller center">
<h1>Wrap-Up</h1>

</section>
<section id="todays-material" class="slide level2 unnumbered smaller">
<h2>Today’s Material</h2>
<ul>
<li>If you didn’t finish the activity, no problem! Be sure to complete the activity outside of class, review the solutions in the course site, and ask any questions on Slack or in office hours.</li>
<li>This is the end of Unit 1, so there are <strong>reflection questions</strong> at the bottom to help you organize the concepts in your mind.</li>
<li>An <strong>R Tutorial Video</strong>, talking through the new code, is posted under the materials for today’s class on the <a href="schedule.html">Course Schedule</a>. This video is OPTIONAL. Decide what’s right for you.</li>
</ul>
</section>
<section id="upcoming-deadlines" class="slide level2 unnumbered smaller">
<h2>Upcoming Deadlines</h2>
<ul>
<li>CP4:
<ul>
<li>due 10 minutes before our next class</li>
<li>covers one R code video</li>
</ul></li>
<li>HW1:
<ul>
<li>due next Tuesday at 11:59 pm</li>
<li>start today if you haven’t already!</li>
<li>review the homework and late work/extension policies on Moodle/Syllabus</li>
<li>universal flexibility: pass/revise grading (as long as your original submission meets certain criteria including on-time submission), late work grace period<br>
</li>
<li>deadline is so we can get timely feedback to you; if you cannot make a deadline, please send me an email/Slack DM (in advance!) and let me know how much time you need</li>
</ul></li>
</ul>
<div class="quarto-auto-generated-content">
<p><img src="images/mac.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://kegrinde.github.io/stat253_coursenotes" class="uri">https://kegrinde.github.io/stat253_coursenotes</a></p>
</div>
</div>
</section></section>

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="L04-cross-validation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="L04-cross-validation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="L04-cross-validation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="L04-cross-validation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'multiplex': {"secret":"17265169610163404115","id":"371a89898d67b023","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>